{"version":3,"sources":["webpack:///static/js/50.839ce1f46030658e5666.js","webpack:///./src/views/platform/efficiencyAnalysis/equipmentTargetAnalysis.vue","webpack:///src/views/platform/efficiencyAnalysis/equipmentTargetAnalysis.vue","webpack:///./src/views/platform/efficiencyAnalysis/equipmentTargetAnalysis.vue?bb78"],"names":["webpackJsonp","/z7V","module","__webpack_exports__","__webpack_require__","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_script_index_0_equipmentTargetAnalysis_vue__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_0_4_vue_loader_lib_template_compiler_index_id_data_v_cfc8b80a_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_template_index_0_equipmentTargetAnalysis_vue__","normalizeComponent","Component","H58q","__WEBPACK_IMPORTED_MODULE_0__util_util_js__","data","selectTime","dateType","energyType","energyTypeList","egyCspStatisticsTableData","energyData","hb_energyData","equipTypeList","equipList","egyCspProportionData","devEgyCspTableData","downTimeTableData","startTime","endTime","workshop","workshopList","equitmentType","equitmentList","unit","egyCspTdcyAnalyzeTime","egyCspTdcyAnalyzeData","dateFormat","xAxisFormat","timeNow","bqTimeStr","hbTimeStr","bqTime","hbTime","columnData1","columnData2","columnData3","methods","inintData","_this","this","date","Date","i","$moment","getTimeFormat","loadColumn1","loadColumn2","loadColumn3","$ajax","all","getEquipTypeList","getEnergyTypeList","getWorkshopList","getEquipList","then","res","status","records","length","id","$nextTick","loadData","getStartEndTime","params","getQueryDataParams","getEgyCspStatisticsTable","getDownTimeTableData","tbTimeStr","tbTime","changeTime","type","url","method","title","me","cycle","statisticsTime","orgIds","targetCycle","targetTypes","$store","state","targetConstant","targetType","energyConsum","contentTypes","targetContentType","energy","contentIds","objTypes","targetSubordinate","equip","objTypeValues","isQueryAll","isOrgId","isContentType","isObjType","datatime","times","_this2","curParam","tbSumValue","bqSumValue","flag","num","_bqValue","_tbValue","j","equipType","k","equipId","dataValue","equipName","name","equipTypeId","targetUnit","m","push","equipTypeName","bqValue","toFixed","bqScale","hbValue","hbScale","scale","concat","sumNum","sumValue1","sumValue2","_i","parseFloat","tbValue","console","log","_j","_k","Number","n","orgId","_m","sort","compare","$message","warning","answerMsg","prop","obj1","obj2","val1","val2","isNaN","_this3","objectType","objectGroups","objectIds","equipRunStatus","stop","isObjectId","isCount","countCycle","groupBys","objectId","hour","stopTimes","frequency","stopNum","changeEquitmentList","organizationId","label","children","mounted","kG2u","render","_vm","_h","$createElement","_c","_self","attrs","padding-content","padding","noHead","_v","time-type","show-time","on","update:timeType","$event","change","model","callback","$$v","expression","maxNum","option-lists","value-key","staticClass","click","_s","ref","width","height","min-height","colums","table-list","data-lists","valueKey","slot","date-time","format","x-axis-format","x-axis-key","staticRenderFns","esExports"],"mappings":"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","file":"static/js/50.839ce1f46030658e5666.js","sourcesContent":["webpackJsonp([50],{\n\n/***/ \"/z7V\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_script_index_0_equipmentTargetAnalysis_vue__ = __webpack_require__(\"H58q\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_0_4_vue_loader_lib_template_compiler_index_id_data_v_cfc8b80a_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_template_index_0_equipmentTargetAnalysis_vue__ = __webpack_require__(\"kG2u\");\nvar normalizeComponent = __webpack_require__(\"J0+h\")\n/* script */\n\n/* template */\n\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_script_index_0_equipmentTargetAnalysis_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_0_4_vue_loader_lib_template_compiler_index_id_data_v_cfc8b80a_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_template_index_0_equipmentTargetAnalysis_vue__[\"a\" /* default */],\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ }),\n\n/***/ \"H58q\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__util_util_js__ = __webpack_require__(\"yt7g\");\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  data: function data() {\n    return {\n      selectTime: \"\", //选择的日期\n      dateType: 5, //日期类型\n      energyType: \"\", //选择的能源种类\n      energyTypeList: [], //能源种类列表\n      egyCspStatisticsTableData: [], //设备能耗统计表格数据\n      energyData: [], //能耗数据\n      hb_energyData: [], //环比能耗数据\n      equipTypeList: [], //设备类型列表\n      equipList: [], //设备列表\n      egyCspProportionData: [],\n      devEgyCspTableData: [], //设备能耗排行榜数据\n      downTimeTableData: [], //设备停机时间排行榜数据\n      startTime: \"\", //开始时间\n      endTime: \"\", //结束时间\n      workshop: \"\", //选择的部门\n      workshopList: [], //部门列表\n      equitmentType: \"\", //设备类型\n      equitmentList: [], //设备类型列表\n      unit: \"\", //能源单位\n      egyCspTdcyAnalyzeTime: \"\",\n      egyCspTdcyAnalyzeData: [], //设备能耗趋势分析数据\n      dateFormat: \"YYYY-MM\", //\n      xAxisFormat: \"DD日\", //X轴日期格式化\n      timeNow: \"\",\n      bqTimeStr: \"本月\",\n      hbTimeStr: \"上月\",\n      bqTime: \"\",\n      hbTime: \"\",\n      columnData1: [],\n      columnData2: [],\n      columnData3: []\n    };\n  },\n\n  methods: {\n    //初始化\n    inintData: function inintData() {\n      var _this = this;\n\n      this.dateType = 5; //默认为月\n      var date = new Date();\n      this.selectTime = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__util_util_js__[\"g\" /* calcTime */])(this.$moment(date, \"YYYY-MM\"), -1, 5, \"YYYY-MM\"); //设置为上个月\n      this.getTimeFormat();\n      this.columnData1 = this.loadColumn1();\n      this.columnData2 = this.loadColumn2();\n      this.columnData3 = this.loadColumn3();\n\n      this.$ajax.all([this.getEquipTypeList(), this.getEnergyTypeList(), this.getWorkshopList(), this.getEquipList()]).then(function (res) {\n        if (res[0].data.status) {\n          _this.equipTypeList = res[0].data.records;\n        }\n\n        if (res[1].data.status) {\n          _this.energyTypeList = res[1].data.records;\n          _this.energyType = 35; //默认选择第一个能源（电力）\n        }\n        if (res[2].data.status) {\n          _this.workshopList = res[2].data.records;\n          if (res[2].data.records != null && res[2].data.records.length > 0) {\n            _this.workshop = res[2].data.records[0].id; //默认选择第一个\n          }\n        }\n        if (res[3].data.status) {\n          _this.equipList = res[3].data.records;\n        }\n        _this.$nextTick(function () {\n          _this.loadData();\n        });\n      });\n    },\n\n    //加载数据\n    loadData: function loadData() {\n      this.egyCspStatisticsTableData = [];\n      this.energyData = [];\n      this.hb_energyData = [];\n      this.egyCspProportionData = [];\n      this.devEgyCspTableData = [];\n      this.downTimeTableData = [];\n      this.egyCspTdcyAnalyzeData = [];\n      this.getTimeFormat();\n      this.columnData1 = this.loadColumn1();\n      this.columnData2 = this.loadColumn2();\n      this.columnData3 = this.loadColumn3();\n      this.getStartEndTime(\"本期\");\n      var params = this.getQueryDataParams();\n      this.getEgyCspStatisticsTable(params, \"本期\");\n      this.getDownTimeTableData();\n    },\n    getTimeFormat: function getTimeFormat() {\n      if (this.dateType == 5) {\n        this.bqTimeStr = \"本月\";\n        this.tbTimeStr = \"上月\";\n        this.bqTime = this.$moment(this.selectTime, \"YYYY-MM\");\n        this.tbTime = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__util_util_js__[\"g\" /* calcTime */])(this.$moment(this.selectTime, \"YYYY-MM\"), -1, 5, \"YYYY-MM\"); //设置为上个月\n      } else if (this.dateType == 8) {\n        this.bqTimeStr = \"本年\";\n        this.tbTimeStr = \"上年\";\n        this.bqTime = this.$moment(this.selectTime, \"YYYY\");\n        this.tbTime = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__util_util_js__[\"g\" /* calcTime */])(this.$moment(this.selectTime, \"YYYY\"), -1, 5, \"YYYY\"); //设置为去年\n      }\n    },\n\n    //改变时间事件\n    changeTime: function changeTime(date, type) {\n      if (date) {\n        this.dateType = type;\n        this.selectTime = date;\n      }\n    },\n\n    //获得能源类型列表\n    getEnergyTypeList: function getEnergyTypeList() {\n      var me = this;\n      return me.$ajax({\n        url: \"rest/analysisData/energy\",\n        method: \"get\",\n        params: {\n          title: \"能源种类\"\n        }\n      });\n    },\n\n\n    //获得车间列表数据\n    getWorkshopList: function getWorkshopList() {\n      var me = this;\n      return me.$ajax({\n        url: \"rest/analysisData/depart\",\n        method: \"get\",\n        params: {\n          title: \"车间资料\"\n        }\n      });\n    },\n\n    //获得设备类型\n    getEquipTypeList: function getEquipTypeList() {\n      var me = this;\n      return me.$ajax({\n        url: \"rest/analysisData/equipType\",\n        method: \"get\",\n        params: {\n          title: \"设备类型\"\n        }\n      });\n    },\n\n    //获得设备资料\n    getEquipList: function getEquipList() {\n      var me = this;\n      return me.$ajax({\n        url: \"rest/analysisData/equip\",\n        method: \"get\",\n        params: {\n          title: \"设备资料\"\n        }\n      });\n    },\n\n    /**\r\n     * 根据选择的条件生成参数\r\n     */\n    getQueryDataParams: function getQueryDataParams() {\n      var me = this;\n      var cycle = \"\";\n      if (me.dateType == 5) {\n        cycle = 3;\n        me.dateFormat = \"YYYY-MM\";\n        me.xAxisFormat = \"YYYY年MM月DD日\";\n        me.timeNow = this.$moment(me.statisticsTime, \"YYYY年MM月\");\n      } else if (me.dateType == 8) {\n        cycle = 5;\n        me.dateFormat = \"YYYY\";\n        me.xAxisFormat = \"YYYY年MM月\";\n        me.timeNow = this.$moment(me.statisticsTime, \"YYYY年\");\n      }\n      var params = {\n        title: \"\",\n        orgIds: \"\", //组织架构ID\n        targetCycle: cycle, //指标周期\n        targetTypes: me.$store.state.targetConstant.targetType.energyConsum, //指标类型\n        contentTypes: me.$store.state.targetConstant.targetContentType.energy, //统计内容类型\n        contentIds: me.energyType, //统计内容ID\n        objTypes: me.$store.state.targetConstant.targetSubordinate.equip, //指标关联对象类型\n        objTypeValues: \"\", //指标关联对象类型对应的值\n        isQueryAll: false, // Boolean,是否所有指标数据\n        startTime: this.startTime, //开始时间\n        endTime: this.endTime, //结束时间\n        isOrgId: true, // Boolean,是否返回部门ID\n        isContentType: true, // Boolean,是否返回指标统计内容类型ID\n        isObjType: \"2\" // String,是否返回指标关联对象,1为班组，2为设备，3为产品\n      };\n\n      return params;\n    },\n\n    //获得开始日期和结束日期\n    //type:本期、 环比\n    getStartEndTime: function getStartEndTime(type) {\n      var datatime = \"\";\n      if (type == \"本期\") {\n        datatime = this.selectTime;\n      } else if (type == \"环比\") {\n        if (this.dateType == 5) {\n          datatime = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__util_util_js__[\"g\" /* calcTime */])(this.$moment(this.selectTime, \"YYYY-MM\"), -1, 5, \"YYYY-MM\"); //设置为上个月\n        } else if (this.dateType == 8) {\n          datatime = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__util_util_js__[\"g\" /* calcTime */])(this.$moment(this.selectTime, \"YYYY\"), -1, 8, \"YYYY\"); //设置为去年\n        }\n      }\n\n      //设置起止日期\n      var times = [];\n      if (this.dateType == 5) {\n        times = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__util_util_js__[\"f\" /* cycleTime */])(datatime, 5);\n        this.startTime = times[0];\n        this.endTime = times[1];\n      } else if (this.dateType == 8) {\n        times = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__util_util_js__[\"f\" /* cycleTime */])(datatime, 8);\n        this.startTime = times[0];\n        this.endTime = times[1];\n      }\n    },\n\n    //获得各类型设备能耗统计数据\n    getEgyCspStatisticsTable: function getEgyCspStatisticsTable(params, type) {\n      var _this2 = this;\n\n      var me = this;\n      var curParam = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__util_util_js__[\"l\" /* deepJSONCopy */])(params);\n      curParam.title = type + \"设备能耗数据\";\n      curParam.startTime = me.startTime;\n      curParam.endTime = me.endTime;\n      me.$ajax({\n        url: \"rest/analysisData/targetData\",\n        method: \"get\",\n        params: curParam\n      }).then(function (res) {\n        if (res.data.status) {\n          if (type == \"本期\") {\n            me.energyData = res.data.records;\n\n            me.getStartEndTime(\"环比\");\n            me.getEgyCspStatisticsTable(params, \"环比\");\n          } else if (type == \"环比\") {\n            me.hb_energyData = res.data.records;\n            //统计出每种设备类型的设备数量以及能耗\n            me.egyCspStatisticsTableData = [];\n            me.devEgyCspTableData = [];\n            var tbSumValue = 0;\n            var bqSumValue = 0;\n            var flag = true; //用于标识第一次统计\n            for (var i = 0; i < me.equipTypeList.length; i++) {\n              var num = 0;\n              var _bqValue = 0;\n              var _tbValue = 0;\n              for (var j = 0; j < me.equipList.length; j++) {\n                if (me.equipTypeList[i].equipType == me.equipList[j].type) {\n                  num += 1;\n                  for (var k = 0; k < me.energyData.length; k++) {\n                    if (me.energyData[k].equipId == me.equipList[j].id) {\n                      _bqValue += me.energyData[k].dataValue;\n                      me.energyData[k].equipName = me.equipList[j].name;\n                      me.energyData[k].equipTypeId = me.equipTypeList[i].equipType;\n                    }\n                    if (k == 0) {\n                      me.unit = me.energyData[k].targetUnit;\n                    }\n                    if (flag) {\n                      bqSumValue += me.energyData[k].dataValue;\n                    }\n                  }\n\n                  for (var m = 0; m < me.hb_energyData.length; m++) {\n                    if (me.hb_energyData[m].equipId == me.equipList[j].id) {\n                      _tbValue += me.hb_energyData[m].dataValue;\n                      me.hb_energyData[m].equipName = me.equipList[j].name;\n                    }\n                    if (flag) {\n                      tbSumValue += me.hb_energyData[m].dataValue;\n                    }\n                  }\n                  flag = false;\n                }\n              }\n              //设备类型能耗数据\n              if (num != 0) {\n                me.egyCspStatisticsTableData.push({\n                  equipType: me.equipTypeList[i].equipType,\n                  equipTypeName: me.equipTypeList[i].equipTypeName,\n                  num: num,\n                  bqValue: _bqValue.toFixed(2),\n                  bqScale: bqSumValue != 0 ? (_bqValue / bqSumValue * 100).toFixed(2) + \" %\" : \"--\",\n                  hbValue: _tbValue.toFixed(2),\n                  hbScale: tbSumValue != 0 ? (_tbValue / tbSumValue * 100).toFixed(2) + \" %\" : \"--\",\n                  scale: _tbValue != 0 ? ((_bqValue - _tbValue) / _tbValue * 100).toFixed(2) + \" %\" : \"--\"\n                });\n              }\n            }\n            me.egyCspTdcyAnalyzeData = me.energyData;\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__util_util_js__[\"o\" /* getFixedDisplayData */])(me.egyCspTdcyAnalyzeData);\n            me.egyCspProportionData = me.egyCspStatisticsTableData.concat();\n\n            var sumNum = 0;\n            var sumValue1 = 0;\n            var sumValue2 = 0;\n            for (var _i = 0; _i < me.egyCspStatisticsTableData.length; _i++) {\n              sumNum += me.egyCspStatisticsTableData[_i].num;\n              sumValue1 += parseFloat(me.egyCspStatisticsTableData[_i].bqValue);\n              sumValue2 += parseFloat(me.egyCspStatisticsTableData[_i].hbValue);\n            }\n\n            me.egyCspStatisticsTableData.push({\n              equipType: \"\",\n              equipTypeName: \"合计\",\n              num: sumNum,\n              bqValue: sumValue1.toFixed(2),\n              bqScale: \"100%\",\n              hbValue: sumValue2.toFixed(2),\n              hbScale: \"100%\",\n              scale: sumValue2 != 0 ? ((sumValue1 - sumValue2) / sumValue2 * 100).toFixed(2) + \" %\" : \"--\"\n            });\n\n            //设备能耗排名数据处理\n            var bqValue = 0;\n            var tbValue = 0;\n            bqSumValue = 0;\n            tbSumValue = 0;\n            var workshop = \"\";\n\n            console.log(\"energyData\", me.energyData);\n            console.log(\"hb_energyData\", me.hb_energyData);\n            for (var _j = 0; _j < me.equipList.length; _j++) {\n              bqValue = 0;\n              tbValue = 0;\n              bqSumValue = 0;\n              tbSumValue = 0;\n              for (var _k = 0; _k < me.energyData.length; _k++) {\n                if (me.energyData[_k].equipId == me.equipList[_j].id) {\n                  bqValue += Number(me.energyData[_k].dataValue);\n                }\n\n                for (var n = 0; n < me.workshopList.length; n++) {\n                  if (me.equipList[_j].orgId == me.workshopList[n].id) {\n                    workshop = me.workshopList[n].name;\n                    break;\n                  }\n                }\n                bqSumValue += Number(me.energyData[_k].dataValue);\n              }\n\n              for (var _m = 0; _m < me.hb_energyData.length; _m++) {\n                if (me.hb_energyData[_m].equipId == me.equipList[_j].id) {\n                  tbValue += me.hb_energyData[_m].dataValue;\n                }\n\n                tbSumValue += Number(me.hb_energyData[_m].dataValue);\n              }\n\n              //设备能耗排名数据\n              me.devEgyCspTableData.push({\n                name: me.equipList[_j].name,\n                bqValue: bqValue.toFixed(2),\n                workshop: workshop,\n                bqScale: bqSumValue != 0 ? (bqValue / bqSumValue * 100).toFixed(2) + \" %\" : \"--\",\n                hbValue: tbValue.toFixed(2),\n                hbScale: tbSumValue != 0 ? (tbValue / tbSumValue * 100).toFixed(2) + \" %\" : \"--\",\n                scale: tbValue != 0 ? ((bqValue - tbValue) / tbValue * 100).toFixed(2) + \" %\" : \"--\"\n              });\n              me.devEgyCspTableData.sort(me.compare(\"bqValue\"));\n            }\n          }\n        } else {\n          _this2.$message.warning(res.data.answerMsg);\n        }\n      });\n    },\n\n    //对数组对象进行排序\n    compare: function compare(prop) {\n      return function (obj1, obj2) {\n        var val1 = obj1[prop];\n        var val2 = obj2[prop];\n        if (!isNaN(Number(val1)) && !isNaN(Number(val2))) {\n          val1 = Number(val1);\n          val2 = Number(val2);\n        }\n        if (val1 > val2) {\n          return -1;\n        } else if (val1 < val2) {\n          return 1;\n        } else {\n          return 0;\n        }\n      };\n    },\n\n\n    //获取设备停机时间排行榜数据\n    getDownTimeTableData: function getDownTimeTableData(params) {\n      var _this3 = this;\n\n      var me = this;\n\n      me.$ajax({\n        url: \"rest/analysisData/runningStatic\",\n        method: \"get\",\n        params: {\n          title: \"设备停机数据\",\n          orgIds: \"\", //组织架构ID\n          objectType: 1,\n          objectGroups: \"\",\n          objectIds: \"\",\n          status: me.$store.state.targetConstant.equipRunStatus.stop,\n          startTime: me.startTime, //开始时间\n          endTime: me.endTime, //结束时间\n          isObjectId: false,\n          isCount: true,\n          countCycle: me.dateType,\n          groupBys: \"10111\" //[部门][对象组][对象][状态][时间]\n        }\n      }).then(function (res) {\n        if (res.data.status) {\n          var workshop = \"\";\n          me.downTimeTableData = [];\n          for (var m = 0; m < res.data.records.length; m++) {\n            for (var j = 0; j < me.equipList.length; j++) {\n              if (res.data.records[m].objectId == me.equipList[j].id) {\n                for (var n = 0; n < me.workshopList.length; n++) {\n                  if (me.equipList[j].orgId == me.workshopList[n].id) {\n                    workshop = me.workshopList[n].name;\n                    break;\n                  }\n                }\n\n                //设备停机数据\n                me.downTimeTableData.push({\n                  name: me.equipList[j].name,\n                  hour: (res.data.records[m].stopTimes / 3600).toFixed(2),\n                  workshop: workshop,\n                  frequency: res.data.records[m].stopNum\n                });\n\n                break;\n              }\n            }\n          }\n          me.downTimeTableData.sort(me.compare(\"hour\"));\n        } else {\n          _this3.$message.warning(res.data.answerMsg);\n        }\n      });\n    },\n\n\n    //改变设备类型列表事件\n    changeEquitmentList: function changeEquitmentList() {\n      var me = this;\n      me.egyCspTdcyAnalyzeData = [];\n      //循环遍历获取所选设备类型和车间的数据\n      for (var i = 0; i < me.energyData.length; i++) {\n        if (me.energyData[i].equipTypeId == me.equitmentType && me.energyData[i].organizationId == me.workshop) {\n          me.egyCspTdcyAnalyzeData = me.egyCspTdcyAnalyzeData.concat(me.energyData[i]);\n        }\n      }\n    },\n    loadColumn1: function loadColumn1() {\n      return [{\n        label: \"设备类型\",\n        prop: \"equipTypeName\"\n      }, {\n        label: \"设备数量(台)\",\n        prop: \"num\"\n      }, {\n        label: this.bqTimeStr + \"能耗统计（\" + this.bqTime + \")\",\n        children: [{\n          label: \"耗能量\",\n          prop: \"bqValue\"\n        }, {\n          label: \"占比\",\n          prop: \"bqScale\"\n        }]\n      }, {\n        label: this.hbTimeStr + \"能耗统计（\" + this.tbTime + \")\",\n        children: [{\n          label: \"耗能量\",\n          prop: \"hbValue\"\n        }, {\n          label: \"占比\",\n          prop: \"hbScale\"\n        }]\n      }, {\n        label: \"环比\",\n        prop: \"scale\"\n      }];\n    },\n    loadColumn2: function loadColumn2() {\n      return [{\n        label: \"设备名称\",\n        prop: \"name\"\n      }, {\n        label: this.bqTimeStr + \"能耗统计（\" + this.bqTime + \")\",\n\n        children: [{\n          label: \"耗能量\",\n          prop: \"bqValue\"\n        }, {\n          label: \"占比\",\n          prop: \"bqScale\"\n        }]\n      }, {\n        label: this.hbTimeStr + \"能耗统计（\" + this.tbTime + \")\",\n        children: [{\n          label: \"耗能量\",\n          prop: \"hbValue\"\n        }, {\n          label: \"占比\",\n          prop: \"hbScale\"\n        }]\n      }, {\n        label: \"环比\",\n        prop: \"scale\"\n      }, {\n        label: \"所属部门\",\n        prop: \"workshop\"\n      }];\n    },\n    loadColumn3: function loadColumn3() {\n      return [{\n        label: \"设备名称\",\n        prop: \"name\"\n      }, {\n        label: this.bqTimeStr + \"停机小时数\",\n        prop: \"hour\"\n      }, {\n        label: this.bqTimeStr + \"停机次数\",\n        prop: \"frequency\"\n      }, {\n        label: \"所属部门\",\n        prop: \"workshop\"\n      }];\n    }\n  },\n  mounted: function mounted() {\n    this.inintData();\n  }\n});\n\n/***/ }),\n\n/***/ \"kG2u\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_c('da-panel', {\n    attrs: {\n      \"padding-content\": \"lrtb\",\n      \"padding\": \"b\",\n      \"noHead\": true\n    }\n  }, [_vm._v(\"\\n    时间：\\n    \"), _c('da-time-select', {\n    attrs: {\n      \"time-type\": _vm.dateType,\n      \"show-time\": [5, 8]\n    },\n    on: {\n      \"update:timeType\": function($event) {\n        _vm.dateType = $event\n      },\n      \"change\": _vm.changeTime\n    },\n    model: {\n      value: (_vm.selectTime),\n      callback: function($$v) {\n        _vm.selectTime = $$v\n      },\n      expression: \"selectTime\"\n    }\n  }), _vm._v(\"\\n    能源：\\n    \"), _c('da-radio-select', {\n    attrs: {\n      \"maxNum\": 5,\n      \"option-lists\": _vm.energyTypeList,\n      \"label\": \"name\",\n      \"value-key\": \"id\"\n    },\n    model: {\n      value: (_vm.energyType),\n      callback: function($$v) {\n        _vm.energyType = $$v\n      },\n      expression: \"energyType\"\n    }\n  }), _vm._v(\" \"), _c('button', {\n    staticClass: \"el-button el-button--primary\",\n    attrs: {\n      \"type\": \"button\"\n    },\n    on: {\n      \"click\": _vm.loadData\n    }\n  }, [_c('span', [_vm._v(\"查询\")])]), _vm._v(\" \"), _c('p', {\n    staticClass: \"pull-right\"\n  }, [_vm._v(\"单位：\" + _vm._s(_vm.unit))])], 1), _vm._v(\" \"), _c('da-panel', {\n    ref: \"panelCount\",\n    attrs: {\n      \"title\": \"设备能耗统计\",\n      \"width\": \"60%\",\n      \"height\": \"auto\",\n      \"padding\": \"rb\",\n      \"padding-content\": \"lrtb\",\n      \"min-height\": \"252px\"\n    }\n  }, [_c('da-table', {\n    staticClass: \"analysis-table\",\n    attrs: {\n      \"colums\": _vm.columnData1,\n      \"table-list\": _vm.egyCspStatisticsTableData\n    }\n  })], 1), _vm._v(\" \"), _c('da-panel', {\n    attrs: {\n      \"title\": \"设备类型能耗占比分析\",\n      \"min-height\": \"200px\",\n      \"width\": \"40%\"\n    }\n  }, [_c('da-pie-chart', {\n    attrs: {\n      \"id\": \"egyCspProportion\",\n      \"title\": \"设备类型能耗占比分析\",\n      \"data-lists\": _vm.egyCspProportionData,\n      \"label\": \"equipTypeName\",\n      \"valueKey\": \"bqValue\"\n    }\n  }, [_vm._v(\">\")])], 1), _vm._v(\" \"), _c('da-panel', {\n    ref: \"panelCount\",\n    attrs: {\n      \"title\": \"设备能耗排行榜\",\n      \"width\": \"60%\",\n      \"height\": \"auto\",\n      \"padding-content\": \"lrtb\",\n      \"min-height\": \"200px\",\n      \"padding\": \"r\"\n    }\n  }, [_c('da-table', {\n    staticClass: \"analysis-table\",\n    attrs: {\n      \"colums\": _vm.columnData2,\n      \"table-list\": _vm.devEgyCspTableData\n    }\n  })], 1), _vm._v(\" \"), _c('da-panel', {\n    ref: \"panelCount\",\n    attrs: {\n      \"title\": \"设备停机时间排行榜\",\n      \"width\": \"40%\",\n      \"height\": \"auto\",\n      \"padding-content\": \"lrtb\",\n      \"min-height\": \"200px\"\n    }\n  }, [_c('da-table', {\n    staticClass: \"analysis-table\",\n    attrs: {\n      \"colums\": _vm.columnData3,\n      \"table-list\": _vm.downTimeTableData\n    }\n  })], 1), _vm._v(\" \"), _c('da-panel', {\n    ref: \"panelCount\",\n    attrs: {\n      \"title\": \"设备能耗趋势分析\",\n      \"width\": \"100%\",\n      \"height\": \"auto\",\n      \"min-height\": \"200px\",\n      \"padding\": \"tb\"\n    }\n  }, [_c('div', {\n    attrs: {\n      \"slot\": \"search\"\n    },\n    slot: \"search\"\n  }, [_vm._v(\"\\n      设备类型：\\n      \"), _c('da-radio-select', {\n    attrs: {\n      \"maxNum\": 1,\n      \"option-lists\": _vm.equipTypeList,\n      \"label\": \"equipTypeName\",\n      \"value-key\": \"equipType\"\n    },\n    on: {\n      \"change\": _vm.changeEquitmentList\n    },\n    model: {\n      value: (_vm.equitmentType),\n      callback: function($$v) {\n        _vm.equitmentType = $$v\n      },\n      expression: \"equitmentType\"\n    }\n  }), _vm._v(\"\\n      部门：\\n      \"), _c('da-radio-select', {\n    attrs: {\n      \"maxNum\": 1,\n      \"option-lists\": _vm.workshopList,\n      \"label\": \"name\",\n      \"value-key\": \"id\"\n    },\n    on: {\n      \"change\": _vm.changeEquitmentList\n    },\n    model: {\n      value: (_vm.workshop),\n      callback: function($$v) {\n        _vm.workshop = $$v\n      },\n      expression: \"workshop\"\n    }\n  })], 1), _vm._v(\" \"), _c('da-line-chart', {\n    attrs: {\n      \"id\": \"egyCspTdcyAnalyze\",\n      \"date-time\": _vm.selectTime,\n      \"data-lists\": _vm.egyCspTdcyAnalyzeData,\n      \"format\": _vm.dateFormat,\n      \"x-axis-format\": _vm.xAxisFormat,\n      \"value-key\": \"dataValue\",\n      \"label\": \"equipName\",\n      \"x-axis-key\": \"dataTime\"\n    }\n  })], 1)], 1)\n}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/50.839ce1f46030658e5666.js","var normalizeComponent = require(\"!../../../../node_modules/_vue-loader@13.0.4@vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/_vue-loader@13.0.4@vue-loader/lib/selector?type=script&index=0!./equipmentTargetAnalysis.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/_vue-loader@13.0.4@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-cfc8b80a\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"}}!../../../../node_modules/_vue-loader@13.0.4@vue-loader/lib/selector?type=template&index=0!./equipmentTargetAnalysis.vue\"\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/platform/efficiencyAnalysis/equipmentTargetAnalysis.vue\n// module id = /z7V\n// module chunks = 50","<template>\r\n  <div>\r\n    <da-panel padding-content=\"lrtb\" padding=\"b\" :noHead=\"true\">\r\n      时间：\r\n      <da-time-select v-model=\"selectTime\" :time-type.sync=\"dateType\" :show-time=\"[5,8]\" @change=\"changeTime\"></da-time-select>\r\n      能源：\r\n      <da-radio-select v-model=\"energyType\" :maxNum=\"5\" :option-lists=\"energyTypeList\" label=\"name\" value-key=\"id\"></da-radio-select>\r\n      <button type=\"button\" class=\"el-button el-button--primary\" @click=\"loadData\">\r\n        <span>查询</span>\r\n      </button>\r\n      <p class=\"pull-right\">单位：{{unit}}</p>\r\n    </da-panel>\r\n\r\n    <da-panel title=\"设备能耗统计\" width=\"60%\" height=\"auto\" padding=\"rb\" padding-content=\"lrtb\" min-height=\"252px\" ref=\"panelCount\">\r\n      <da-table class=\"analysis-table\" :colums=\"columnData1\" :table-list=\"egyCspStatisticsTableData\"></da-table>\r\n    </da-panel>\r\n\r\n    <da-panel title=\"设备类型能耗占比分析\" min-height=\"200px\" width=\"40%\">\r\n      <da-pie-chart id=\"egyCspProportion\" title=\"设备类型能耗占比分析\" :data-lists=\"egyCspProportionData\" label=\"equipTypeName\" valueKey=\"bqValue\">></da-pie-chart>\r\n    </da-panel>\r\n\r\n    <da-panel title=\"设备能耗排行榜\" width=\"60%\" height=\"auto\" padding-content=\"lrtb\" min-height=\"200px\" padding=\"r\" ref=\"panelCount\">\r\n      <da-table class=\"analysis-table\" :colums=\"columnData2\" :table-list=\"devEgyCspTableData\"></da-table>\r\n    </da-panel>\r\n    <da-panel title=\"设备停机时间排行榜\" width=\"40%\" height=\"auto\" padding-content=\"lrtb\" min-height=\"200px\" ref=\"panelCount\">\r\n      <da-table class=\"analysis-table\" :colums=\"columnData3\" :table-list=\"downTimeTableData\"></da-table>\r\n    </da-panel>\r\n    <da-panel title=\"设备能耗趋势分析\" width=\"100%\" height=\"auto\" min-height=\"200px\" padding=\"tb\" ref=\"panelCount\">\r\n      <div slot=\"search\">\r\n        设备类型：\r\n        <da-radio-select v-model=\"equitmentType\" :maxNum=\"1\" :option-lists=\"equipTypeList\" label=\"equipTypeName\" value-key=\"equipType\" @change=\"changeEquitmentList\"></da-radio-select>\r\n        部门：\r\n        <da-radio-select v-model=\"workshop\" :maxNum=\"1\" :option-lists=\"workshopList\" label=\"name\" value-key=\"id\" @change=\"changeEquitmentList\"></da-radio-select>\r\n      </div>\r\n      <da-line-chart id=\"egyCspTdcyAnalyze\" :date-time=\"selectTime\" :data-lists=\"egyCspTdcyAnalyzeData\" :format=\"dateFormat\" :x-axis-format=\"xAxisFormat\" value-key=\"dataValue\" label=\"equipName\" x-axis-key=\"dataTime\"></da-line-chart>\r\n\r\n    </da-panel>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {\r\n  calcTime,\r\n  cycleTime,\r\n  deepJSONCopy,\r\n  getFixedDisplayData\r\n} from \"@/util/util.js\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      selectTime: \"\", //选择的日期\r\n      dateType: 5, //日期类型\r\n      energyType: \"\", //选择的能源种类\r\n      energyTypeList: [], //能源种类列表\r\n      egyCspStatisticsTableData: [], //设备能耗统计表格数据\r\n      energyData: [], //能耗数据\r\n      hb_energyData: [], //环比能耗数据\r\n      equipTypeList: [], //设备类型列表\r\n      equipList: [], //设备列表\r\n      egyCspProportionData: [],\r\n      devEgyCspTableData: [], //设备能耗排行榜数据\r\n      downTimeTableData: [], //设备停机时间排行榜数据\r\n      startTime: \"\", //开始时间\r\n      endTime: \"\", //结束时间\r\n      workshop: \"\", //选择的部门\r\n      workshopList: [], //部门列表\r\n      equitmentType: \"\", //设备类型\r\n      equitmentList: [], //设备类型列表\r\n      unit: \"\", //能源单位\r\n      egyCspTdcyAnalyzeTime: \"\",\r\n      egyCspTdcyAnalyzeData: [], //设备能耗趋势分析数据\r\n      dateFormat: \"YYYY-MM\", //\r\n      xAxisFormat: \"DD日\", //X轴日期格式化\r\n      timeNow: \"\",\r\n      bqTimeStr: \"本月\",\r\n      hbTimeStr: \"上月\",\r\n      bqTime: \"\",\r\n      hbTime: \"\",\r\n      columnData1: [],\r\n      columnData2: [],\r\n      columnData3: []\r\n    };\r\n  },\r\n  methods: {\r\n    //初始化\r\n    inintData() {\r\n      this.dateType = 5; //默认为月\r\n      let date = new Date();\r\n      this.selectTime = calcTime(\r\n        this.$moment(date, \"YYYY-MM\"),\r\n        -1,\r\n        5,\r\n        \"YYYY-MM\"\r\n      ); //设置为上个月\r\n      this.getTimeFormat();\r\n      this.columnData1 = this.loadColumn1();\r\n      this.columnData2 = this.loadColumn2();\r\n      this.columnData3 = this.loadColumn3();\r\n\r\n      this.$ajax\r\n        .all([\r\n          this.getEquipTypeList(),\r\n          this.getEnergyTypeList(),\r\n          this.getWorkshopList(),\r\n          this.getEquipList()\r\n        ])\r\n        .then(res => {\r\n          if (res[0].data.status) {\r\n            this.equipTypeList = res[0].data.records;\r\n          }\r\n\r\n          if (res[1].data.status) {\r\n            this.energyTypeList = res[1].data.records;\r\n            this.energyType = 35; //默认选择第一个能源（电力）\r\n          }\r\n          if (res[2].data.status) {\r\n            this.workshopList = res[2].data.records;\r\n            if (res[2].data.records != null && res[2].data.records.length > 0) {\r\n              this.workshop = res[2].data.records[0].id; //默认选择第一个\r\n            }\r\n          }\r\n          if (res[3].data.status) {\r\n            this.equipList = res[3].data.records;\r\n          }\r\n          this.$nextTick(() => {\r\n            this.loadData();\r\n          });\r\n        });\r\n    },\r\n    //加载数据\r\n    loadData() {\r\n      this.egyCspStatisticsTableData = [];\r\n      this.energyData = [];\r\n      this.hb_energyData = [];\r\n      this.egyCspProportionData = [];\r\n      this.devEgyCspTableData = [];\r\n      this.downTimeTableData = [];\r\n      this.egyCspTdcyAnalyzeData = [];\r\n      this.getTimeFormat();\r\n      this.columnData1 = this.loadColumn1();\r\n      this.columnData2 = this.loadColumn2();\r\n      this.columnData3 = this.loadColumn3();\r\n      this.getStartEndTime(\"本期\");\r\n      let params = this.getQueryDataParams();\r\n      this.getEgyCspStatisticsTable(params, \"本期\");\r\n      this.getDownTimeTableData();\r\n    },\r\n    getTimeFormat() {\r\n      if (this.dateType == 5) {\r\n        this.bqTimeStr = \"本月\";\r\n        this.tbTimeStr = \"上月\";\r\n        this.bqTime = this.$moment(this.selectTime, \"YYYY-MM\");\r\n        this.tbTime = calcTime(\r\n          this.$moment(this.selectTime, \"YYYY-MM\"),\r\n          -1,\r\n          5,\r\n          \"YYYY-MM\"\r\n        ); //设置为上个月\r\n      } else if (this.dateType == 8) {\r\n        this.bqTimeStr = \"本年\";\r\n        this.tbTimeStr = \"上年\";\r\n        this.bqTime = this.$moment(this.selectTime, \"YYYY\");\r\n        this.tbTime = calcTime(\r\n          this.$moment(this.selectTime, \"YYYY\"),\r\n          -1,\r\n          5,\r\n          \"YYYY\"\r\n        ); //设置为去年\r\n      }\r\n    },\r\n    //改变时间事件\r\n    changeTime(date, type) {\r\n      if (date) {\r\n        this.dateType = type;\r\n        this.selectTime = date;\r\n      }\r\n    },\r\n    //获得能源类型列表\r\n    getEnergyTypeList() {\r\n      let me = this;\r\n      return me.$ajax({\r\n        url: \"rest/analysisData/energy\",\r\n        method: \"get\",\r\n        params: {\r\n          title: \"能源种类\"\r\n        }\r\n      });\r\n    },\r\n\r\n    //获得车间列表数据\r\n    getWorkshopList() {\r\n      let me = this;\r\n      return me.$ajax({\r\n        url: \"rest/analysisData/depart\",\r\n        method: \"get\",\r\n        params: {\r\n          title: \"车间资料\"\r\n        }\r\n      });\r\n    },\r\n    //获得设备类型\r\n    getEquipTypeList() {\r\n      let me = this;\r\n      return me.$ajax({\r\n        url: \"rest/analysisData/equipType\",\r\n        method: \"get\",\r\n        params: {\r\n          title: \"设备类型\"\r\n        }\r\n      });\r\n    },\r\n    //获得设备资料\r\n    getEquipList() {\r\n      let me = this;\r\n      return me.$ajax({\r\n        url: \"rest/analysisData/equip\",\r\n        method: \"get\",\r\n        params: {\r\n          title: \"设备资料\"\r\n        }\r\n      });\r\n    },\r\n    /**\r\n     * 根据选择的条件生成参数\r\n     */\r\n    getQueryDataParams() {\r\n      let me = this;\r\n      let cycle = \"\";\r\n      if (me.dateType == 5) {\r\n        cycle = 3;\r\n        me.dateFormat = \"YYYY-MM\";\r\n        me.xAxisFormat = \"YYYY年MM月DD日\";\r\n        me.timeNow = this.$moment(me.statisticsTime, \"YYYY年MM月\");\r\n      } else if (me.dateType == 8) {\r\n        cycle = 5;\r\n        me.dateFormat = \"YYYY\";\r\n        me.xAxisFormat = \"YYYY年MM月\";\r\n        me.timeNow = this.$moment(me.statisticsTime, \"YYYY年\");\r\n      }\r\n      let params = {\r\n        title: \"\",\r\n        orgIds: \"\", //组织架构ID\r\n        targetCycle: cycle, //指标周期\r\n        targetTypes: me.$store.state.targetConstant.targetType.energyConsum, //指标类型\r\n        contentTypes: me.$store.state.targetConstant.targetContentType.energy, //统计内容类型\r\n        contentIds: me.energyType, //统计内容ID\r\n        objTypes: me.$store.state.targetConstant.targetSubordinate.equip, //指标关联对象类型\r\n        objTypeValues: \"\", //指标关联对象类型对应的值\r\n        isQueryAll: false, // Boolean,是否所有指标数据\r\n        startTime: this.startTime, //开始时间\r\n        endTime: this.endTime, //结束时间\r\n        isOrgId: true, // Boolean,是否返回部门ID\r\n        isContentType: true, // Boolean,是否返回指标统计内容类型ID\r\n        isObjType: \"2\" // String,是否返回指标关联对象,1为班组，2为设备，3为产品\r\n      };\r\n\r\n      return params;\r\n    },\r\n    //获得开始日期和结束日期\r\n    //type:本期、 环比\r\n    getStartEndTime(type) {\r\n      let datatime = \"\";\r\n      if (type == \"本期\") {\r\n        datatime = this.selectTime;\r\n      } else if (type == \"环比\") {\r\n        if (this.dateType == 5) {\r\n          datatime = calcTime(\r\n            this.$moment(this.selectTime, \"YYYY-MM\"),\r\n            -1,\r\n            5,\r\n            \"YYYY-MM\"\r\n          ); //设置为上个月\r\n        } else if (this.dateType == 8) {\r\n          datatime = calcTime(\r\n            this.$moment(this.selectTime, \"YYYY\"),\r\n            -1,\r\n            8,\r\n            \"YYYY\"\r\n          ); //设置为去年\r\n        }\r\n      }\r\n\r\n      //设置起止日期\r\n      let times = [];\r\n      if (this.dateType == 5) {\r\n        times = cycleTime(datatime, 5);\r\n        this.startTime = times[0];\r\n        this.endTime = times[1];\r\n      } else if (this.dateType == 8) {\r\n        times = cycleTime(datatime, 8);\r\n        this.startTime = times[0];\r\n        this.endTime = times[1];\r\n      }\r\n    },\r\n    //获得各类型设备能耗统计数据\r\n    getEgyCspStatisticsTable(params, type) {\r\n      let me = this;\r\n      let curParam = deepJSONCopy(params);\r\n      curParam.title = type + \"设备能耗数据\";\r\n      curParam.startTime = me.startTime;\r\n      curParam.endTime = me.endTime;\r\n      me\r\n        .$ajax({\r\n          url: \"rest/analysisData/targetData\",\r\n          method: \"get\",\r\n          params: curParam\r\n        })\r\n        .then(res => {\r\n          if (res.data.status) {\r\n            if (type == \"本期\") {\r\n              me.energyData = res.data.records;\r\n\r\n              me.getStartEndTime(\"环比\");\r\n              me.getEgyCspStatisticsTable(params, \"环比\");\r\n            } else if (type == \"环比\") {\r\n              me.hb_energyData = res.data.records;\r\n              //统计出每种设备类型的设备数量以及能耗\r\n              me.egyCspStatisticsTableData = [];\r\n              me.devEgyCspTableData = [];\r\n              let tbSumValue = 0;\r\n              let bqSumValue = 0;\r\n              let flag = true; //用于标识第一次统计\r\n              for (let i = 0; i < me.equipTypeList.length; i++) {\r\n                let num = 0;\r\n                let bqValue = 0;\r\n                let tbValue = 0;\r\n                for (let j = 0; j < me.equipList.length; j++) {\r\n                  if (me.equipTypeList[i].equipType == me.equipList[j].type) {\r\n                    num += 1;\r\n                    for (let k = 0; k < me.energyData.length; k++) {\r\n                      if (me.energyData[k].equipId == me.equipList[j].id) {\r\n                        bqValue += me.energyData[k].dataValue;\r\n                        me.energyData[k].equipName = me.equipList[j].name;\r\n                        me.energyData[k].equipTypeId =\r\n                          me.equipTypeList[i].equipType;\r\n                      }\r\n                      if (k == 0) {\r\n                        me.unit = me.energyData[k].targetUnit;\r\n                      }\r\n                      if (flag) {\r\n                        bqSumValue += me.energyData[k].dataValue;\r\n                      }\r\n                    }\r\n\r\n                    for (let m = 0; m < me.hb_energyData.length; m++) {\r\n                      if (me.hb_energyData[m].equipId == me.equipList[j].id) {\r\n                        tbValue += me.hb_energyData[m].dataValue;\r\n                        me.hb_energyData[m].equipName = me.equipList[j].name;\r\n                      }\r\n                      if (flag) {\r\n                        tbSumValue += me.hb_energyData[m].dataValue;\r\n                      }\r\n                    }\r\n                    flag = false;\r\n                  }\r\n                }\r\n                //设备类型能耗数据\r\n                if (num != 0) {\r\n                  me.egyCspStatisticsTableData.push({\r\n                    equipType: me.equipTypeList[i].equipType,\r\n                    equipTypeName: me.equipTypeList[i].equipTypeName,\r\n                    num: num,\r\n                    bqValue: bqValue.toFixed(2),\r\n                    bqScale:\r\n                      bqSumValue != 0\r\n                        ? (bqValue / bqSumValue * 100).toFixed(2) + \" %\"\r\n                        : \"--\",\r\n                    hbValue: tbValue.toFixed(2),\r\n                    hbScale:\r\n                      tbSumValue != 0\r\n                        ? (tbValue / tbSumValue * 100).toFixed(2) + \" %\"\r\n                        : \"--\",\r\n                    scale:\r\n                      tbValue != 0\r\n                        ? ((bqValue - tbValue) / tbValue * 100).toFixed(2) +\r\n                          \" %\"\r\n                        : \"--\"\r\n                  });\r\n                }\r\n              }\r\n              me.egyCspTdcyAnalyzeData = me.energyData;\r\n              getFixedDisplayData(me.egyCspTdcyAnalyzeData);\r\n              me.egyCspProportionData = me.egyCspStatisticsTableData.concat();\r\n\r\n              let sumNum = 0;\r\n              let sumValue1 = 0;\r\n              let sumValue2 = 0;\r\n              for (let i = 0; i < me.egyCspStatisticsTableData.length; i++) {\r\n                sumNum += me.egyCspStatisticsTableData[i].num;\r\n                sumValue1 += parseFloat(\r\n                  me.egyCspStatisticsTableData[i].bqValue\r\n                );\r\n                sumValue2 += parseFloat(\r\n                  me.egyCspStatisticsTableData[i].hbValue\r\n                );\r\n              }\r\n\r\n              me.egyCspStatisticsTableData.push({\r\n                equipType: \"\",\r\n                equipTypeName: \"合计\",\r\n                num: sumNum,\r\n                bqValue: sumValue1.toFixed(2),\r\n                bqScale: \"100%\",\r\n                hbValue: sumValue2.toFixed(2),\r\n                hbScale: \"100%\",\r\n                scale:\r\n                  sumValue2 != 0\r\n                    ? ((sumValue1 - sumValue2) / sumValue2 * 100).toFixed(2) +\r\n                      \" %\"\r\n                    : \"--\"\r\n              });\r\n\r\n              //设备能耗排名数据处理\r\n              let bqValue = 0;\r\n              let tbValue = 0;\r\n              bqSumValue = 0;\r\n              tbSumValue = 0;\r\n              let workshop = \"\";\r\n\r\n              console.log(\"energyData\", me.energyData);\r\n              console.log(\"hb_energyData\", me.hb_energyData);\r\n              for (let j = 0; j < me.equipList.length; j++) {\r\n                bqValue = 0;\r\n                tbValue = 0;\r\n                bqSumValue = 0;\r\n                tbSumValue = 0;\r\n                for (let k = 0; k < me.energyData.length; k++) {\r\n                  if (me.energyData[k].equipId == me.equipList[j].id) {\r\n                    bqValue += Number(me.energyData[k].dataValue);\r\n                  }\r\n\r\n                  for (let n = 0; n < me.workshopList.length; n++) {\r\n                    if (me.equipList[j].orgId == me.workshopList[n].id) {\r\n                      workshop = me.workshopList[n].name;\r\n                      break;\r\n                    }\r\n                  }\r\n                  bqSumValue += Number(me.energyData[k].dataValue);\r\n                }\r\n\r\n                for (let m = 0; m < me.hb_energyData.length; m++) {\r\n                  if (me.hb_energyData[m].equipId == me.equipList[j].id) {\r\n                    tbValue += me.hb_energyData[m].dataValue;\r\n                  }\r\n\r\n                  tbSumValue += Number(me.hb_energyData[m].dataValue);\r\n                }\r\n\r\n                //设备能耗排名数据\r\n                me.devEgyCspTableData.push({\r\n                  name: me.equipList[j].name,\r\n                  bqValue: bqValue.toFixed(2),\r\n                  workshop: workshop,\r\n                  bqScale:\r\n                    bqSumValue != 0\r\n                      ? (bqValue / bqSumValue * 100).toFixed(2) + \" %\"\r\n                      : \"--\",\r\n                  hbValue: tbValue.toFixed(2),\r\n                  hbScale:\r\n                    tbSumValue != 0\r\n                      ? (tbValue / tbSumValue * 100).toFixed(2) + \" %\"\r\n                      : \"--\",\r\n                  scale:\r\n                    tbValue != 0\r\n                      ? ((bqValue - tbValue) / tbValue * 100).toFixed(2) + \" %\"\r\n                      : \"--\"\r\n                });\r\n                me.devEgyCspTableData.sort(me.compare(\"bqValue\"));\r\n              }\r\n            }\r\n          } else {\r\n            this.$message.warning(res.data.answerMsg);\r\n          }\r\n        });\r\n    },\r\n    //对数组对象进行排序\r\n    compare(prop) {\r\n      return function(obj1, obj2) {\r\n        var val1 = obj1[prop];\r\n        var val2 = obj2[prop];\r\n        if (!isNaN(Number(val1)) && !isNaN(Number(val2))) {\r\n          val1 = Number(val1);\r\n          val2 = Number(val2);\r\n        }\r\n        if (val1 > val2) {\r\n          return -1;\r\n        } else if (val1 < val2) {\r\n          return 1;\r\n        } else {\r\n          return 0;\r\n        }\r\n      };\r\n    },\r\n\r\n    //获取设备停机时间排行榜数据\r\n    getDownTimeTableData(params) {\r\n      let me = this;\r\n\r\n      me\r\n        .$ajax({\r\n          url: \"rest/analysisData/runningStatic\",\r\n          method: \"get\",\r\n          params: {\r\n            title: \"设备停机数据\",\r\n            orgIds: \"\", //组织架构ID\r\n            objectType: 1,\r\n            objectGroups: \"\",\r\n            objectIds: \"\",\r\n            status: me.$store.state.targetConstant.equipRunStatus.stop,\r\n            startTime: me.startTime, //开始时间\r\n            endTime: me.endTime, //结束时间\r\n            isObjectId: false,\r\n            isCount: true,\r\n            countCycle: me.dateType,\r\n            groupBys: \"10111\" //[部门][对象组][对象][状态][时间]\r\n          }\r\n        })\r\n        .then(res => {\r\n          if (res.data.status) {\r\n            let workshop = \"\";\r\n            me.downTimeTableData = [];\r\n            for (let m = 0; m < res.data.records.length; m++) {\r\n              for (let j = 0; j < me.equipList.length; j++) {\r\n                if (res.data.records[m].objectId == me.equipList[j].id) {\r\n                  for (let n = 0; n < me.workshopList.length; n++) {\r\n                    if (me.equipList[j].orgId == me.workshopList[n].id) {\r\n                      workshop = me.workshopList[n].name;\r\n                      break;\r\n                    }\r\n                  }\r\n\r\n                  //设备停机数据\r\n                  me.downTimeTableData.push({\r\n                    name: me.equipList[j].name,\r\n                    hour: (res.data.records[m].stopTimes / 3600).toFixed(2),\r\n                    workshop: workshop,\r\n                    frequency: res.data.records[m].stopNum\r\n                  });\r\n\r\n                  break;\r\n                }\r\n              }\r\n            }\r\n            me.downTimeTableData.sort(me.compare(\"hour\"));\r\n          } else {\r\n            this.$message.warning(res.data.answerMsg);\r\n          }\r\n        });\r\n    },\r\n\r\n    //改变设备类型列表事件\r\n    changeEquitmentList() {\r\n      let me = this;\r\n      me.egyCspTdcyAnalyzeData = [];\r\n      //循环遍历获取所选设备类型和车间的数据\r\n      for (let i = 0; i < me.energyData.length; i++) {\r\n        if (\r\n          me.energyData[i].equipTypeId == me.equitmentType &&\r\n          me.energyData[i].organizationId == me.workshop\r\n        ) {\r\n          me.egyCspTdcyAnalyzeData = me.egyCspTdcyAnalyzeData.concat(\r\n            me.energyData[i]\r\n          );\r\n        }\r\n      }\r\n    },\r\n    loadColumn1() {\r\n      return [\r\n        {\r\n          label: \"设备类型\",\r\n          prop: \"equipTypeName\"\r\n        },\r\n        {\r\n          label: \"设备数量(台)\",\r\n          prop: \"num\"\r\n        },\r\n        {\r\n          label: this.bqTimeStr + \"能耗统计（\" + this.bqTime + \")\",\r\n          children: [\r\n            {\r\n              label: \"耗能量\",\r\n              prop: \"bqValue\"\r\n            },\r\n            {\r\n              label: \"占比\",\r\n              prop: \"bqScale\"\r\n            }\r\n          ]\r\n        },\r\n\r\n        {\r\n          label: this.hbTimeStr + \"能耗统计（\" + this.tbTime + \")\",\r\n          children: [\r\n            {\r\n              label: \"耗能量\",\r\n              prop: \"hbValue\"\r\n            },\r\n            {\r\n              label: \"占比\",\r\n              prop: \"hbScale\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          label: \"环比\",\r\n          prop: \"scale\"\r\n        }\r\n      ];\r\n    },\r\n    loadColumn2() {\r\n      return [\r\n        {\r\n          label: \"设备名称\",\r\n          prop: \"name\"\r\n        },\r\n        {\r\n          label: this.bqTimeStr + \"能耗统计（\" + this.bqTime + \")\",\r\n\r\n          children: [\r\n            {\r\n              label: \"耗能量\",\r\n              prop: \"bqValue\"\r\n            },\r\n            {\r\n              label: \"占比\",\r\n              prop: \"bqScale\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          label: this.hbTimeStr + \"能耗统计（\" + this.tbTime + \")\",\r\n          children: [\r\n            {\r\n              label: \"耗能量\",\r\n              prop: \"hbValue\"\r\n            },\r\n            {\r\n              label: \"占比\",\r\n              prop: \"hbScale\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          label: \"环比\",\r\n          prop: \"scale\"\r\n        },\r\n        {\r\n          label: \"所属部门\",\r\n          prop: \"workshop\"\r\n        }\r\n      ];\r\n    },\r\n    loadColumn3() {\r\n      return [\r\n        {\r\n          label: \"设备名称\",\r\n          prop: \"name\"\r\n        },\r\n        {\r\n          label: this.bqTimeStr + \"停机小时数\",\r\n          prop: \"hour\"\r\n        },\r\n\r\n        {\r\n          label: this.bqTimeStr + \"停机次数\",\r\n          prop: \"frequency\"\r\n        },\r\n        {\r\n          label: \"所属部门\",\r\n          prop: \"workshop\"\r\n        }\r\n      ];\r\n    }\r\n  },\r\n  mounted() {\r\n    this.inintData();\r\n  }\r\n};\r\n</script>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/platform/efficiencyAnalysis/equipmentTargetAnalysis.vue?14d86138","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_c('da-panel', {\n    attrs: {\n      \"padding-content\": \"lrtb\",\n      \"padding\": \"b\",\n      \"noHead\": true\n    }\n  }, [_vm._v(\"\\n    时间：\\n    \"), _c('da-time-select', {\n    attrs: {\n      \"time-type\": _vm.dateType,\n      \"show-time\": [5, 8]\n    },\n    on: {\n      \"update:timeType\": function($event) {\n        _vm.dateType = $event\n      },\n      \"change\": _vm.changeTime\n    },\n    model: {\n      value: (_vm.selectTime),\n      callback: function($$v) {\n        _vm.selectTime = $$v\n      },\n      expression: \"selectTime\"\n    }\n  }), _vm._v(\"\\n    能源：\\n    \"), _c('da-radio-select', {\n    attrs: {\n      \"maxNum\": 5,\n      \"option-lists\": _vm.energyTypeList,\n      \"label\": \"name\",\n      \"value-key\": \"id\"\n    },\n    model: {\n      value: (_vm.energyType),\n      callback: function($$v) {\n        _vm.energyType = $$v\n      },\n      expression: \"energyType\"\n    }\n  }), _vm._v(\" \"), _c('button', {\n    staticClass: \"el-button el-button--primary\",\n    attrs: {\n      \"type\": \"button\"\n    },\n    on: {\n      \"click\": _vm.loadData\n    }\n  }, [_c('span', [_vm._v(\"查询\")])]), _vm._v(\" \"), _c('p', {\n    staticClass: \"pull-right\"\n  }, [_vm._v(\"单位：\" + _vm._s(_vm.unit))])], 1), _vm._v(\" \"), _c('da-panel', {\n    ref: \"panelCount\",\n    attrs: {\n      \"title\": \"设备能耗统计\",\n      \"width\": \"60%\",\n      \"height\": \"auto\",\n      \"padding\": \"rb\",\n      \"padding-content\": \"lrtb\",\n      \"min-height\": \"252px\"\n    }\n  }, [_c('da-table', {\n    staticClass: \"analysis-table\",\n    attrs: {\n      \"colums\": _vm.columnData1,\n      \"table-list\": _vm.egyCspStatisticsTableData\n    }\n  })], 1), _vm._v(\" \"), _c('da-panel', {\n    attrs: {\n      \"title\": \"设备类型能耗占比分析\",\n      \"min-height\": \"200px\",\n      \"width\": \"40%\"\n    }\n  }, [_c('da-pie-chart', {\n    attrs: {\n      \"id\": \"egyCspProportion\",\n      \"title\": \"设备类型能耗占比分析\",\n      \"data-lists\": _vm.egyCspProportionData,\n      \"label\": \"equipTypeName\",\n      \"valueKey\": \"bqValue\"\n    }\n  }, [_vm._v(\">\")])], 1), _vm._v(\" \"), _c('da-panel', {\n    ref: \"panelCount\",\n    attrs: {\n      \"title\": \"设备能耗排行榜\",\n      \"width\": \"60%\",\n      \"height\": \"auto\",\n      \"padding-content\": \"lrtb\",\n      \"min-height\": \"200px\",\n      \"padding\": \"r\"\n    }\n  }, [_c('da-table', {\n    staticClass: \"analysis-table\",\n    attrs: {\n      \"colums\": _vm.columnData2,\n      \"table-list\": _vm.devEgyCspTableData\n    }\n  })], 1), _vm._v(\" \"), _c('da-panel', {\n    ref: \"panelCount\",\n    attrs: {\n      \"title\": \"设备停机时间排行榜\",\n      \"width\": \"40%\",\n      \"height\": \"auto\",\n      \"padding-content\": \"lrtb\",\n      \"min-height\": \"200px\"\n    }\n  }, [_c('da-table', {\n    staticClass: \"analysis-table\",\n    attrs: {\n      \"colums\": _vm.columnData3,\n      \"table-list\": _vm.downTimeTableData\n    }\n  })], 1), _vm._v(\" \"), _c('da-panel', {\n    ref: \"panelCount\",\n    attrs: {\n      \"title\": \"设备能耗趋势分析\",\n      \"width\": \"100%\",\n      \"height\": \"auto\",\n      \"min-height\": \"200px\",\n      \"padding\": \"tb\"\n    }\n  }, [_c('div', {\n    attrs: {\n      \"slot\": \"search\"\n    },\n    slot: \"search\"\n  }, [_vm._v(\"\\n      设备类型：\\n      \"), _c('da-radio-select', {\n    attrs: {\n      \"maxNum\": 1,\n      \"option-lists\": _vm.equipTypeList,\n      \"label\": \"equipTypeName\",\n      \"value-key\": \"equipType\"\n    },\n    on: {\n      \"change\": _vm.changeEquitmentList\n    },\n    model: {\n      value: (_vm.equitmentType),\n      callback: function($$v) {\n        _vm.equitmentType = $$v\n      },\n      expression: \"equitmentType\"\n    }\n  }), _vm._v(\"\\n      部门：\\n      \"), _c('da-radio-select', {\n    attrs: {\n      \"maxNum\": 1,\n      \"option-lists\": _vm.workshopList,\n      \"label\": \"name\",\n      \"value-key\": \"id\"\n    },\n    on: {\n      \"change\": _vm.changeEquitmentList\n    },\n    model: {\n      value: (_vm.workshop),\n      callback: function($$v) {\n        _vm.workshop = $$v\n      },\n      expression: \"workshop\"\n    }\n  })], 1), _vm._v(\" \"), _c('da-line-chart', {\n    attrs: {\n      \"id\": \"egyCspTdcyAnalyze\",\n      \"date-time\": _vm.selectTime,\n      \"data-lists\": _vm.egyCspTdcyAnalyzeData,\n      \"format\": _vm.dateFormat,\n      \"x-axis-format\": _vm.xAxisFormat,\n      \"value-key\": \"dataValue\",\n      \"label\": \"equipName\",\n      \"x-axis-key\": \"dataTime\"\n    }\n  })], 1)], 1)\n}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_vue-loader@13.0.4@vue-loader/lib/template-compiler?{\"id\":\"data-v-cfc8b80a\",\"hasScoped\":false,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"}}!./~/_vue-loader@13.0.4@vue-loader/lib/selector.js?type=template&index=0!./src/views/platform/efficiencyAnalysis/equipmentTargetAnalysis.vue\n// module id = kG2u\n// module chunks = 50"],"sourceRoot":""}