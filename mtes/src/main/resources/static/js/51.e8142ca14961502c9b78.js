webpackJsonp([51],{KUBJ:function(t,e,a){"use strict";var r=a("yt7g");e.a={data:function(){return{rdsEnergySubitem:"",energySubitemList:[],rdsCompare:"",dateArr:new Array,dateType:"",tjqDate:new Date,jqDate:new Date,startTime:new Date,endTime:new Date,treeDefaultKeys:{},orgTreeData:[],treeData:"",sspTrendData:[],tjq_sspTrendData:[],jq_sspTrendData:[],sspTrendTime:"",energyQuotaData:{},product:"",productList:[],benchMarking:"",benchMarkingList:[],sglSspTrendData:[],tjq_sglSspTrendData:[],jq_sglSspTrendData:[],sglSspTrendTime:"",unitEnergyQuotaData:{},dateFormat:"YYYY-MM",xAxisFormat:"DD日",legendFormat:"YYYY年MM月",lineDataAttr:[{name:"定额值",yIndex:0,attr:"quota",color:"#FF0000"},{name:"标杆值",yIndex:0,attr:"benchmark",color:"#00BB00"}],compareList:[{compareName:"环比",id:1},{compareName:"同比",id:2},{compareName:"自定义",id:3}]}},methods:{inintData:function(){var t=this;this.rdsCompare=1,this.dateType="5";var e=new Date;e=this.$moment(e,"YYYY-MM"),this.tjqDate=a.i(r.g)(e,-1,5,"YYYY-MM"),this.jqDate=a.i(r.g)(e,-2,5,"YYYY-MM"),this.dateArr[0]=this.$moment(this.tjqDate,"YYYY-MM"),this.dateArr[1]=this.$moment(this.jqDate,"YYYY-MM"),this.rdsEnergySubitem=35,this.$ajax.all([this.getEnergySubitemList(),this.getOrgTreeData()]).then(function(e){e[0].data.status&&(t.energySubitemList=e[0].data.records),e[1].data.status&&(t.treeDefaultKeys={nodeKey:"id",checkedKeys:[e[1].data.records[0].id],expandedKeys:[]},t.orgTreeData=e[1].data.records,t.treeData=e[1].data.records[0].id.toString()),t.$nextTick(function(){t.dateArr=[t.dateArr[0],t.dateArr[1]],t.getProductList()})})},getEnergySubitemList:function(){return this.$ajax({url:"rest/analysisData/energy",method:"get",params:{title:"能源种类"}})},getOrgTreeData:function(){return this.$ajax({url:"rest/analysisData/departTree",method:"get",params:{title:"组织架构数据"}})},getProductList:function(){var t=this,e=this,a={title:"产品资料",orgIds:e.treeData};e.$ajax({url:"rest/analysisData/product",method:"get",params:a}).then(function(a){a.data.status?(e.productList=a.data.records,null!=e.productList&&e.productList.length>0?(t.product=a.data.records[0].id,e.loadData()):t.product=""):t.$message.warning(a.data.answerMsg)})},compareChange:function(){1==this.rdsCompare?5==this.dateType?this.dateArr[1]=a.i(r.g)(this.dateArr[0],-1,5,"YYYY-MM"):8==this.dateType&&(this.dateArr[1]=a.i(r.g)(this.dateArr[0],-1,8,"YYYY")):2==this.rdsCompare?5==this.dateType?this.dateArr[1]=a.i(r.g)(this.dateArr[0],-1,8,"YYYY-MM"):8==this.dateType&&(this.dateArr[1]=a.i(r.g)(this.dateArr[0],-1,8,"YYYY")):this.rdsCompare,this.dateArr=[this.dateArr[0],this.dateArr[1]]},orgChange:function(t){this.treeData=t.obj.id,this.getProductList()},loadData:function(){this.sglSspTrendData=[],this.sspTrendData=[],this.energyQuotaData={},this.unitEnergyQuotaData={};var t=this.getQueryDataParams();this.getEnergyQuotaData(t),this.getUnitEnergyQuotaData(t),this.getSspTrendData(t,"统计期"),this.getSglSspTrendData(t,"统计期")},getQueryDataParams:function(){var t=this,e=t.rdsEnergySubitem,a="";return 5==t.dateType?(a=3,t.dateFormat="YYYY-MM",t.xAxisFormat="DD日",t.legendFormat="YYYY年MM月"):8==t.dateType&&(a=5,t.dateFormat="YYYY",t.xAxisFormat="MM月",t.legendFormat="YYYY年"),t.getStartEndTime(this.dateArr[0]),{title:"",orgIds:t.treeData,targetCycle:a,targetTypes:"",contentTypes:"",contentIds:e,objTypes:"",objTypeValues:"",isQueryAll:!1,startTime:"",endTime:"",isOrgId:!1,isContentType:!1,isObjType:""}},getSspTrendData:function(t,e){var s=this,n=this,i=a.i(r.l)(t);i.title=e+"能耗曲线数据",i.startTime=this.startTime,i.endTime=this.endTime,i.targetTypes=n.$store.state.targetConstant.targetType.energyConsum,i.contentTypes=n.$store.state.targetConstant.targetContentType.energy,i.objTypes="",i.objTypeValues="",n.$ajax({url:"rest/analysisData/targetData",method:"get",params:i}).then(function(i){i.data.status?"统计期"==e?(n.tjq_sspTrendData=i.data.records,n.getStartEndTime(s.dateArr[1]),n.getSspTrendData(t,"基期")):(n.jq_sspTrendData=i.data.records,n.sspTrendData=n.tjq_sspTrendData.concat(n.jq_sspTrendData),a.i(r.o)(n.sspTrendData)):s.$message.warning(i.data.answerMsg)})},getEnergyQuotaData:function(t){var e=this,s=this,n=a.i(r.l)(t);n.title="能耗定额数据",n.startTime=s.startTime,n.endTime=s.endTime,n.targetTypes=s.$store.state.targetConstant.targetType.energyConsum,n.contentTypes=s.$store.state.targetConstant.targetContentType.energy,n.benchmarkQuota="010",s.$ajax({url:"rest/analysisData/targetBenchmarkData",method:"get",params:n}).then(function(t){t.data.status?s.energyQuotaData=t.data.records:(s.energyQuotaData={},e.$message.warning(t.data.answerMsg))})},getStartEndTime:function(t){var e=[];5==this.dateType?e=a.i(r.f)(t,5):8==this.dateType&&(e=a.i(r.f)(t,8)),this.startTime=e[0],this.endTime=e[1]},dateChange:function(t,e){t&&t[0]&&t[1]&&(this.dateType=e,1==this.rdsCompare?5==this.dateType?this.dateArr[1]=a.i(r.g)(t[0],-1,5,"YYYY-MM"):8==this.dateType&&(this.dateArr[1]=a.i(r.g)(t[0],-1,8,"YYYY")):2==this.rdsCompare?5==this.dateType?this.dateArr[1]=a.i(r.g)(t[0],-1,8,"YYYY-MM"):8==this.dateType&&(this.dateArr[1]=a.i(r.g)(t[0],-1,8,"YYYY")):this.rdsCompare)},productChange:function(){var t=this.getQueryDataParams();this.getUnitEnergyQuotaData(t),this.getSglSspTrendData(t,"统计期")},benchMarkingChange:function(t){for(var e=[],a=0;a<this.benchMarkingList.length;a++)this.benchMarkingList[a].typeName==t&&(e[0]=this.benchMarkingList[a],this.unitEnergyQuotaData.benchmark=e,this.$refs.singleSonsumptionTrend.changeTarget(this.unitEnergyQuotaData))},getSglSspTrendData:function(t,e){var s=this,n=this,i=a.i(r.l)(t);i.title=e+"单耗曲线数据",i.startTime=this.startTime,i.endTime=this.endTime,i.targetTypes=n.$store.state.targetConstant.targetType.unitProductEnergyConsum,i.contentTypes=n.$store.state.targetConstant.targetContentType.energy,i.objTypes=n.$store.state.targetConstant.targetSubordinate.product,i.objTypeValues=n.product,n.$ajax({url:"rest/analysisData/targetData",method:"get",params:i}).then(function(i){i.data.status?"统计期"==e?(n.tjq_sglSspTrendData=i.data.records,n.getStartEndTime(s.dateArr[1]),n.getSglSspTrendData(t,"基期")):(n.jq_sglSspTrendData=i.data.records,n.sglSspTrendData=n.tjq_sglSspTrendData.concat(n.jq_sglSspTrendData),a.i(r.o)(n.sglSspTrendData)):("统计期"==e?(n.tjq_sglSspTrendData=[],n.getStartEndTime(s.dateArr[1]),n.getSglSspTrendData(t,"基期")):n.jq_sglSspTrendData=[],s.$message.warning(i.data.answerMsg))})},getUnitEnergyQuotaData:function(t){var e=this,s=this,n=a.i(r.l)(t);n.title="单耗定额及标杆数据",n.startTime=s.startTime,n.endTime=s.endTime,n.targetTypes=s.$store.state.targetConstant.targetType.unitProductEnergyConsum,n.contentTypes=s.$store.state.targetConstant.targetContentType.energy,n.benchmarkQuota="110",n.objTypes=s.$store.state.targetConstant.targetSubordinate.product,n.objTypeValues=s.product,s.$ajax({url:"rest/analysisData/targetBenchmarkData",method:"get",params:n}).then(function(t){if(t.data.status){var a={},r=[];null!=t.data.records.benchmark&&t.data.records.benchmark.length>0&&(r[0]=t.data.records.benchmark[0],a.benchmark=r,a.quota=t.data.records.quota,s.unitEnergyQuotaData=a),s.benchMarkingList=t.data.records.benchmark}else e.$message.warning(t.data.answerMsg)})}},mounted:function(){this.inintData()}}},Vjl0:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("da-panel",{attrs:{width:"100%",height:"auto",noHead:!0,"padding-content":"tblr"}},[a("da-radio-select",{staticClass:"mar-tb-5",attrs:{"max-num":5,"option-lists":t.energySubitemList,label:"name","value-key":"id"},model:{value:t.rdsEnergySubitem,callback:function(e){t.rdsEnergySubitem=e},expression:"rdsEnergySubitem"}}),t._v(" "),a("da-radio-select",{attrs:{"max-num":5,"option-lists":t.compareList,label:"compareName","value-key":"id"},on:{change:t.compareChange},model:{value:t.rdsCompare,callback:function(e){t.rdsCompare=e},expression:"rdsCompare"}}),t._v(" "),a("da-time-range",{attrs:{"time-type":t.dateType,"show-time":[5,8],"is-picker-end":!1},on:{"update:timeType":function(e){t.dateType=e},change:t.dateChange},model:{value:t.dateArr,callback:function(e){t.dateArr=e},expression:"dateArr"}}),t._v(" "),a("button",{staticClass:"el-button el-button--primary",attrs:{type:"button"},on:{click:t.loadData}},[a("span",[t._v("查询")])])],1),t._v(" "),a("da-panel",{ref:"panelCount",attrs:{title:"组织架构",width:"30%",overflow:"auto",height:"252px",padding:"tr"}},[a("da-tree",{attrs:{"data-lists":t.orgTreeData,"default-expand":!0,"expand-on-click-node":!1,defaultKeys:t.treeDefaultKeys},on:{currentChange:t.orgChange}})],1),t._v(" "),a("da-panel",{ref:"panelCount",attrs:{title:"能耗趋势分析",width:"70%",height:"auto",padding:"t"}},[a("da-line-chart",{attrs:{id:"sonsumptionTrend","date-time":t.dateArr[0],format:t.dateFormat,"x-axis-format":t.xAxisFormat,"data-lists":t.sspTrendData,"line-data":t.energyQuotaData,label:"dataTime","x-axis-key":"dataTime","legend-format":t.legendFormat,"line-data-attr":t.lineDataAttr}}),t._v(" "),a("div")],1),t._v(" "),a("da-panel",{ref:"panelCount",attrs:{title:"单耗趋势分析",width:"100%",height:"auto","min-height":"200px",padding:"tb"}},[a("div",{attrs:{slot:"search"},slot:"search"},[t._v("\n      产品：\n      "),a("da-radio-select",{attrs:{maxNum:1,"option-lists":t.productList,label:"name","value-key":"id"},on:{change:t.productChange},model:{value:t.product,callback:function(e){t.product=e},expression:"product"}}),t._v("\n      标杆：\n      "),a("da-radio-select",{attrs:{maxNum:1,"option-lists":t.benchMarkingList,label:"typeName","value-key":"typeName"},on:{change:t.benchMarkingChange},model:{value:t.benchMarking,callback:function(e){t.benchMarking=e},expression:"benchMarking"}})],1),t._v(" "),a("da-line-chart",{ref:"singleSonsumptionTrend",attrs:{id:"singleSonsumptionTrend","date-time":t.dateArr[0],format:t.dateFormat,"x-axis-format":t.xAxisFormat,"data-lists":t.sglSspTrendData,"line-data":t.unitEnergyQuotaData,label:"dataTime","x-axis-key":"dataTime","legend-format":t.legendFormat,"line-data-attr":t.lineDataAttr}}),t._v(" "),a("div")],1)],1)},s=[],n={render:r,staticRenderFns:s};e.a=n},Zt4M:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("KUBJ"),s=a("Vjl0"),n=a("J0+h"),i=n(r.a,s.a,null,null,null);e.default=i.exports}});
//# sourceMappingURL=51.e8142ca14961502c9b78.js.map