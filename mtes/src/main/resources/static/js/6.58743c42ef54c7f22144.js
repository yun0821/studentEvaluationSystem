webpackJsonp([6],{"/QzV":function(e,t,o){var r=o("HhKJ");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o("FIqI")("2b950d8a",r,!0,{})},AGvZ:function(e,t,o){"use strict";var r=o("IHPB"),a=o.n(r),s=o("3cXf"),i=o.n(s),n=o("yt7g"),l=o("Yj6d"),d=o("x8pc"),c={name:"",parentId:"",path:"",showHeight:"",showWidth:"",showSort:"",bigIcon:"",smallIcon:"",status:!0,showType:3,remark:""};t.a={name:"module",components:{treeSort:l.a,selectList:d.a},data:function(){return{columns:[{label:"名称",prop:"name",width:"200"},{label:"url",prop:"path",align:"left"},{label:"图标",prop:"smallIcon",align:"left"},{label:"打开方式",prop:"showType",displace:{0:"弹窗方式加载",1:"iframe方式加载",2:"浏览器新页面",3:"后台选项卡方式"}}],dataSource:[],addVisible:!1,isAdd:"",searchForm:{form:{name:"",path:"",status:""},hasChildren:!0},disableIds:[],moduleId:"",editSourceTable:[],sourceTitle:"",parentModule:[{id:"0",name:"根模块",children:[]}],form:i()(c),parentModuleTree:[],addRules:this.eachValidate({name:{required:!0,maxString:20},path:{maxString:200},bigIcon:{maxString:50},smallIcon:{maxString:50},remark:{maxString:100},showHeight:{max:99999},showWidth:{max:99999},showSort:{max:99999999999}}),props:{value:"id",label:"name",children:"children"},newArr:[],newParentId:"",sourceVisible:!1,transfer:{chooseList:[],accredited:[]},list:{before:[],after:[]},searchSourceForm:{name:"",note:""},query:{},index:0,necessaryList:{before:[],after:[]},moduleSortDialogVisible:!1,groupVisible:!1,groupModuleLists:[],groupInitCheck:{groupCheckedLists:[],detailCheckedLists:[]},groupSelect:{handleSaveList:{handleList:[],resourceList:[]},handleDeleteList:{handleList:[],resourceList:[]}}}},methods:{cancelAddDialog:function(){this.addVisible=!1},saveAddDialog:function(e){var t=this,o=this;delete o.form.parentName,this.$refs[e].validate(function(e){if(!e)return!1;o.isAdd?t.$ajax.post("rest/module",o.form).then(function(e){e.data.status?(t.$message.success(e.data.answerMsg),t.searchModule()):t.$message.error(e.data.answerMsg),t.addVisible=!1}).catch(function(e){}):t.$ajax({url:"rest/module",method:"PUT",data:o.form}).then(function(e){e.data.status?(o.$message.success(e.data.answerMsg),t.searchModule()):t.$message.error(e.data.answerMsg),t.addVisible=!1})})},editModule:function(e){this.isAdd=!1;var t={};for(var o in e)0!==o.indexOf("_")&&(t[o]=e[o]);delete t.children,this.findParentId(e,t)},searchModule:function(){var e=this;this.$ajax.get("rest/module",{params:{formdata:i()(this.searchForm.form),hasChildren:this.searchForm.hasChildren},loadingTarget:this.$refs.treeGrid}).then(function(t){var o=t.data;o.status?e.dataSource=o.records:e.$message.error(o.msg)}).catch(function(e){})},findParentId:function(e,t){var r=this,a=this;a.$ajax({url:"rest/module",method:"get",params:{formdata:{},hasChildren:""}}).then(function(s){if(s.data.status&&(a.parentModuleTree=s.data.records,void 0!=e)){var i={};o.i(n.j)(s.data.records,"id","name",i)}r.addVisible=!0,t&&(r.form=t)})},addModule:function(){this.isAdd=!0,this.form=JSON.parse(i()(c)),this.findParentId()},disableSource:function(){var e=this;this.$alertMsg("确定禁用所选的模块吗？禁用后该模块功能将停止使用！","操作确认","warning",function(){if(0==e.disableIds.length)e.$message.warning("请选择资源");else{var t=e.disableIds.join(",");e.$ajax({url:"rest/module/state/disable",method:"put",data:t}).then(function(t){t.data.status?(e.$message.warning("该模块及子模块功能已停止使用！"),e.searchModule(),e.disableIds=[]):e.$message.error(t.data.answerMsg)}).catch(function(e){})}})},enableSource:function(){var e=this;if(0==e.disableIds.length)e.$message.warning("请选择资源");else{var t=e.disableIds.join(",");e.$ajax({url:"rest/module/state/enable",method:"PUT",data:t}).then(function(t){t.data.status?(e.$message.success(t.data.answerMsg),e.searchModule(),e.disableIds=[]):e.$message.error(t.data.answerMsg)})}},disableModule:function(e){var t=[];e&&e.length>0&&e.forEach(function(e){t.push(e.id)}),this.disableIds=JSON.parse(i()(t))},sourceModuleId:function(e){this.moduleId=e.id,this.sourceVisible=!0,this.sourceTitle=e.name+"模块资源配置"},groupAllGroup:function(e){var t=this;this.groupVisible=!0,this.moduleId=e.id,this.$ajax.get("rest/module/allHandle").then(function(o){t.groupModuleLists=o.data.records,t.getCheckedModule(e.id),t.getGroupModuleId(e.id),t.getCheckedGroup(e.id)})},openGroup:function(){},closeGroupModule:function(){},getCheckedModule:function(e){var t=this;this.$ajax.get("rest/module/moduleResource/checked",{params:{moduleId:e}}).then(function(e){t.transfer.accredited=e.data.records,t.list.before=t.transfer.accredited.map(function(e){return e.id}),t.list.after=t.transfer.accredited.map(function(e){return e.id})})},getCheckedGroup:function(e){var t=this;this.$ajax.get("rest/module/moduleHandleResource",{params:{moduleId:e}}).then(function(e){t.groupInitCheck.detailCheckedLists=e.data.records})},getGroupModuleId:function(e){var t=this;this.$ajax.get("rest/module/moduleHandle",{params:{moduleId:e}}).then(function(e){t.groupInitCheck.groupCheckedLists=e.data.records})},saveGroup:function(){var e=this;this.$ajax.post("rest/module/handleAndResource",this.groupSelect).then(function(t){t.data.status&&(e.groupVisible=!1)})},openSource:function(){this.$nextTick(function(){var e=this;this.$ajax.get("rest/module/baseResource/list").then(function(t){t.data.status&&(e.transfer.chooseList=t.data.records)}).catch().then(function(){e.getCheckedModule(e.moduleId)}).then(function(){var t=e.$el.querySelectorAll(".el-transfer-panel__body")[1].querySelectorAll(".transfer-accredited");e.transfer.accredited.forEach(function(o){o.isNecessary&&(e.necessaryList.before.push(o.id),[].concat(a()(t)).forEach(function(e){e.value==o.id&&(e.checked=!0)}))})})})},closeDialog:function(e){this.$refs[e].resetFields(),this.form=JSON.parse(i()(c))},saveClick:function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],o=arguments[2];return e.map(function(e,a){var s={};if(s.moduleId=r.moduleId,s.resourceId=e,void 0!==t)for(var i=0;i<r.transfer.accredited.length;i++)r.transfer.accredited[i].id===s.resourceId&&(s.id=r.transfer.accredited[i].moduleResourceId);return void 0!==o&&(s.isNecessary=!1),s})}var t=this;this.necessaryList.after=[];var r=this,s=o.i(n.i)(this.list.before,this.list.after),i=this.$el.querySelectorAll(".el-transfer-panel__body")[1].querySelectorAll(".transfer-accredited");[].concat(a()(i)).forEach(function(e){e.checked&&t.necessaryList.after.push(e.value)});var l=o.i(n.i)(this.necessaryList.before,this.necessaryList.after),d=(function(e){var t=[];return e.forEach(function(e){for(var o=0;o<r.transfer.accredited.length;o++)if(r.transfer.accredited[o].id===e){var a={moduleId:r.moduleId,resourceId:e,id:r.transfer.accredited[o].moduleResourceId,isNecessary:!0};t.push(a)}}),t}(l.saveList).concat(e(l.deleteList,"deleteUser",!1)),e(s.saveList));d.forEach(function(e){l.saveList.forEach(function(t){t==e.resourceId&&(e.isNecessary=!0)})}),this.$ajax.post("rest/module/moduleResource",{saveList:d,deleteList:e(s.deleteList,"deleteUser")}).then(function(e){e.data.status?(t.$message.success(e.data.answerMsg),t.sourceVisible=!1):t.$message.error(e.data.answerMsg)})},handleRoleChange:function(e){this.list.after=e.value},searchSourceModule:function(){this.query=o.i(n.k)(this.searchSourceForm)},closeSourceModule:function(){this.searchSourceForm={name:"",note:""},this.necessaryList.before=[],this.necessaryList.after=[]},rendContent:function(e,t){return e("span",null,[e("span",{class:"transfer-content"},[t.name])])},sendBack:function(){this.moduleSortDialogVisible=!1,this.searchModule()},rowClassName:function(e,t){return e.row.status?"":"disabled"}},created:function(){},mounted:function(){this.searchModule()},computed:{title:function(){return this.isAdd?"新增模块":"编辑模块"}}}},B1Pr:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"selectTree"}},[o("el-tree",{ref:"selectTree",staticClass:"el-tree-treeSort",attrs:{data:e.data,props:e.props,load:e.loadNode,"expand-on-click-node":!1,"highlight-current":!0,"render-content":e.renderContent,"node-key":e.mysortId,parentId:e.parentId,accordion:e.accordion,"show-checkbox":e.showCheckbox,"default-expanded-keys":e.defaultExpanded,"check-strictly":!0},on:{"node-click":e.nodeClick,"current-change":e.currentChange,"check-change":e.checkChange}}),e._v(" "),o("el-button-group",{attrs:{id:"el-btn-treeSort"}},[o("el-button",{attrs:{type:"primary"},on:{click:e.moveUp}},[o("i",{staticClass:"el-icon-arrow-up el-icon--up"}),e._v("上移\n    ")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.moveDown}},[e._v("下移\n      "),o("i",{staticClass:"el-icon-arrow-down el-icon--down"})]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.send}},[e._v("保存\n      "),o("i",{staticClass:"el-icon-upload2"})])],1)],1)},a=[],s={render:r,staticRenderFns:a};t.a=s},BZUC:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"module_div_header"},[o("div",{staticClass:"module_div_search"},[o("div",{staticClass:"module_div_operation"},[o("el-button",{attrs:{icon:"my-xinzeng"},on:{click:e.addModule}},[e._v("新增")]),e._v(" "),o("el-button",{attrs:{icon:"close"},on:{click:e.disableSource}},[e._v("禁用")]),e._v(" "),o("el-button",{attrs:{icon:"check"},on:{click:e.enableSource}},[e._v("启用")])],1),e._v(" "),o("el-form",{staticClass:"module-div-form",attrs:{inline:!0,model:e.searchForm}},[o("el-form-item",{attrs:{label:"名称"}},[o("el-input",{model:{value:e.searchForm.form.name,callback:function(t){e.$set(e.searchForm.form,"name",t)},expression:"searchForm.form.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"url"}},[o("el-input",{model:{value:e.searchForm.form.path,callback:function(t){e.$set(e.searchForm.form,"path",t)},expression:"searchForm.form.path"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"状态"}},[o("el-select",{model:{value:e.searchForm.form.status,callback:function(t){e.$set(e.searchForm.form,"status",t)},expression:"searchForm.form.status"}},[o("el-option",{attrs:{label:"正常",value:!0}}),e._v(" "),o("el-option",{attrs:{label:"禁用",value:!1}}),e._v(" "),o("el-option",{attrs:{label:"全部",value:""}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"是否包含子模块"}},[o("el-select",{model:{value:e.searchForm.hasChildren,callback:function(t){e.$set(e.searchForm,"hasChildren",t)},expression:"searchForm.hasChildren"}},[o("el-option",{attrs:{label:"包含",value:!0}}),e._v(" "),o("el-option",{attrs:{label:"不包含",value:!1}})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search_button",on:{click:e.searchModule}},[e._v("查询")])],1)],1)],1),e._v(" "),o("div",[o("da-treeGrid",{ref:"treeGrid",attrs:{columns:e.columns,"tree-structure":!0,"data-source":e.dataSource,"row-class-name":e.rowClassName,showSelection:!0,setTreeHeight:"true"},on:{selectionChange:function(t){e.disableModule(t)}}},[o("el-table-column",{attrs:{slot:"operation",label:"操作",width:"195",align:"left","header-align":"center"},slot:"operation",scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(o){e.editModule(t.row)}}},[e._v("\n            编辑\n          ")]),e._v(" "),o("el-button",{attrs:{type:"info",size:"small"},on:{click:function(o){e.sourceModuleId(t.row)}}},[e._v("\n            资源\n          ")]),e._v(" "),o("el-button",{attrs:{type:"info",size:"small"},on:{click:function(o){e.groupAllGroup(t.row)}}},[e._v("\n            资源分组\n          ")])]}}])})],1)],1),e._v(" "),o("da-dialog",{staticClass:"module-div-addDialog",attrs:{title:e.title,visible:e.addVisible,size:"tiny"},on:{"update:visible":function(t){e.addVisible=t},close:function(t){e.closeDialog("moudle_add")}}},[o("el-form",{ref:"moudle_add",attrs:{model:e.form,"label-width":"80px",rules:e.addRules}},[o("el-form-item",{attrs:{label:"模块名称",prop:"name"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"上级模块"}},[o("da-select-tree",{attrs:{data:e.parentModuleTree,defaultExpandAll:!0},model:{value:e.form.parentId,callback:function(t){e.$set(e.form,"parentId",t)},expression:"form.parentId"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"访问地址",prop:"path"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"默认高度",prop:"showHeight"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.showHeight,callback:function(t){e.$set(e.form,"showHeight",e._n(t))},expression:"form.showHeight"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"默认宽度",prop:"showWidth"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.showWidth,callback:function(t){e.$set(e.form,"showWidth",e._n(t))},expression:"form.showWidth"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"显示顺序",prop:"showSort"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.showSort,callback:function(t){e.$set(e.form,"showSort",e._n(t))},expression:"form.showSort"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"大图标",prop:"bigIcon"}},[o("el-input",{attrs:{"auto-complete":"off",maxlength:50},model:{value:e.form.bigIcon,callback:function(t){e.$set(e.form,"bigIcon",t)},expression:"form.bigIcon"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"小图标",prop:"smallIcon"}},[o("el-input",{attrs:{"auto-complete":"off",maxlength:50},model:{value:e.form.smallIcon,callback:function(t){e.$set(e.form,"smallIcon",t)},expression:"form.smallIcon"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"状态"}},[o("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[o("el-radio",{attrs:{label:!0}},[e._v("正常")]),e._v(" "),o("el-radio",{attrs:{label:!1}},[e._v("禁用")])],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"显示方式"}},[o("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:e.form.showType,callback:function(t){e.$set(e.form,"showType",t)},expression:"form.showType"}},[o("el-option",{attrs:{label:"DIV方式弹窗（常规弹出窗口）",value:0}}),e._v(" "),o("el-option",{attrs:{label:"iframe方式弹窗（支持外部加载）",value:1}}),e._v(" "),o("el-option",{attrs:{label:"浏览器新选项卡（即在新页面中打开）",value:2}}),e._v(" "),o("el-option",{attrs:{label:"系统选项卡（默认）",value:3}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"备注",prop:"remark"}},[o("el-input",{attrs:{"auto-complete":"off",type:"textarea",rows:3},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer ",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveAddDialog("moudle_add")}}},[e._v("确 定")]),e._v(" "),o("el-button",{on:{click:e.cancelAddDialog}},[e._v("取 消")])],1)],1),e._v(" "),o("da-dialog",{staticClass:"module-div-sourceDialog",attrs:{title:e.sourceTitle,visible:e.sourceVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.sourceVisible=t},open:e.openSource,close:e.closeSourceModule}},[o("el-form",{staticClass:"module-div-form",attrs:{inline:!0,model:e.searchSourceForm}},[o("el-form-item",{attrs:{label:"名称"}},[o("el-input",{model:{value:e.searchSourceForm.name,callback:function(t){e.$set(e.searchSourceForm,"name",t)},expression:"searchSourceForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{model:{value:e.searchSourceForm.note,callback:function(t){e.$set(e.searchSourceForm,"note",t)},expression:"searchSourceForm.note"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search_button",on:{click:e.searchSourceModule}},[e._v("查询")])],1)],1),e._v(" "),o("da-transfer",{attrs:{chooseList:e.transfer.chooseList,accredited:e.transfer.accredited,filterList:e.query,filterType:"1",rend:e.rendContent,saveClick:e.saveClick,titles:["未授权资源","已授权资源"],mysortId:"id",mysortName:"note",buttonTexts:["删除","授权","保存"]},on:{transfer:e.handleRoleChange}})],1),e._v(" "),o("da-dialog",{staticClass:"module-div-sourceDialog",attrs:{title:"资源配置",visible:e.groupVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.groupVisible=t},open:e.openGroup,close:e.closeGroupModule}},[o("select-list",{attrs:{"group-list":e.groupModuleLists,"detail-list":e.transfer.accredited,"module-id":e.moduleId,"init-check":e.groupInitCheck},model:{value:e.groupSelect,callback:function(t){e.groupSelect=t},expression:"groupSelect"}}),e._v(" "),o("span",[o("el-button",{attrs:{type:"button"},on:{click:e.saveGroup}},[e._v("保存")]),e._v(" "),o("el-button",{attrs:{type:"button"},on:{click:function(t){e.groupVisible=!1}}},[e._v("关闭")])],1)],1)],1)},a=[],s={render:r,staticRenderFns:a};t.a=s},HhKJ:function(e,t,o){t=e.exports=o("acE3")(!0),t.push([e.i,"#selectTree{margin:0 auto}#selectTree .el-tree-node__label{user-select:none;color:#000}#selectTree .el-tree-treeSort{border:1px solid rgba(0,0,0,.12);box-shadow:10px 10px 50px rgba(0,0,0,.12),0 0 6px rgba(0,0,0,.04);max-height:480px;overflow:auto}#el-btn-treeSort{margin-top:10px}#el-btn-treeSort button{margin-left:2px}","",{version:3,sources:["C:/vscode/ysems_webapp/src/components/base/treeSort.vue"],names:[],mappings:"AACA,YACE,aAAe,CAChB,AACD,iCACE,iBAAkB,AAClB,UAAY,CACb,AACD,8BACE,iCAAsC,AACtC,kEAA4E,AAC5E,iBAAkB,AAClB,aAAe,CAChB,AACD,iBACE,eAAiB,CAClB,AACD,wBACE,eAAiB,CAClB",file:"treeSort.vue",sourcesContent:["\n#selectTree {\n  margin: 0 auto;\n}\n#selectTree .el-tree-node__label {\n  user-select: none;\n  color: #000;\n}\n#selectTree .el-tree-treeSort {\n  border: 1px solid rgba(0, 0, 0, 0.12);\n  box-shadow: 10px 10px 50px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);\n  max-height: 480px;\n  overflow: auto;\n}\n#el-btn-treeSort {\n  margin-top: 10px;\n}\n#el-btn-treeSort button {\n  margin-left: 2px;\n}\n\n"],sourceRoot:""}])},IHPB:function(e,t,o){"use strict";t.__esModule=!0;var r=o("kfHR"),a=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return(0,a.default)(e)}},PUDX:function(e,t,o){t=e.exports=o("acE3")(!0),t.push([e.i,".wrap[data-v-32973260]{display:flex}.left[data-v-32973260],.right[data-v-32973260]{flex:1}.groupActive[data-v-32973260]{background-color:#e1ffb9}","",{version:3,sources:["C:/vscode/ysems_webapp/src/components/base/selectList.vue"],names:[],mappings:"AACA,uBACE,YAAc,CACf,AACD,+CAEE,MAAQ,CACT,AACD,8BACE,wBAA0B,CAC3B",file:"selectList.vue",sourcesContent:["\n.wrap[data-v-32973260] {\r\n  display: flex;\n}\n.left[data-v-32973260],\r\n.right[data-v-32973260] {\r\n  flex: 1;\n}\n.groupActive[data-v-32973260] {\r\n  background-color: #e1ffb9;\n}\r\n"],sourceRoot:""}])},Yj6d:function(e,t,o){"use strict";function r(e){o("/QzV")}var a=o("Zqn1"),s=o("B1Pr"),i=o("J0+h"),n=r,l=i(a.a,s.a,n,null,null);t.a=l.exports},Zqn1:function(e,t,o){"use strict";var r=o("rVsN"),a=o.n(r),s=o("IHPB"),i=o.n(s);o("yt7g");t.a={name:"treeSort",components:{},data:function(){return{defaultExpanded:[],localData:[],tempNode:[],isCtrl:!1,isShift:!1,isChanged:!1,initSort:[],initSortKey:[]}},props:{clearLis:{type:Boolean,default:!0},showCheckbox:{type:Boolean,default:!0},data:{type:Array,default:function(){return[]}},accordion:{type:Boolean,default:!1},mysortId:{type:String,default:"id"},mysortName:{type:String,default:"name"},sortStr:{type:String,default:"displaySort"},sortCode:{type:String,default:"2"},urlType:{type:String,default:"PUT"},urlLink:{type:String,default:"rest/encapsulation/sort"},parentId:{type:String,default:"parentId"},props:{type:Object,default:function(){return{children:"children"}}}},methods:{renderContent:function(e,t){var o=t.node;t.data,t.store;return e("span",{},[o.label])},loadNode:function(e,t){var o=[];if(0==e.level)return t(this.data),void console.log("再找");!function e(t){if(!t.parent)return t;for(var r=0;r<t.parent.childNodes.length;r++){if(t.parent.childNodes[r].label==t.label){o.push(r);break}}return e(t.parent)}(e);for(var r=this.data,a=o.length;a>0;a--)r=r[o[a-1]].children;t(this.readchildNode(r))},readchildNode:function(e,t){var o=[];return e&&e.forEach(function(e){o.push(e)}),o},nodeClick:function(e,t,o){var r=this,a=r.isChoose(t);if(r.isShift||r.isCtrl){if(r.tempNode[0]&&e[r.parentId]!==r.tempNode[0].data[r.parentId])return void r.$message("请选择同级部门");if(r.tempNode[0])if(r.isShift)if(t.key==r.tempNode[0].key)r.tempNode=[];else{r.tempNode.splice(1,r.tempNode.length-1);for(var s=0,i=0;i<t.parent.childNodes.length;i++){var n=t.parent.childNodes[i];if(n.key!=t.key&&n.key!=r.tempNode[0].key||s++,s>0&&r.tempNode.push(n),s>=2){r.tempNode.shift();break}}}else r.isCtrl&&(a?r.tempNode.splice(a,1):r.tempNode.push(t));else r.tempNode.push(t)}else r.tempNode=[],a||r.tempNode.push(t);r.showCheckbox&&r.setChecked()},isChoose:function(e){for(var t=0;t<this.tempNode.length;t++)if(e.key==this.tempNode[t].key)return t;return!1},setChecked:function(){var e=[];this.tempNode.forEach(function(t,o){e.push(t.key)}),this.$refs.selectTree.setCheckedKeys(e,!0,!1)},currentChange:function(e,t){},checkChange:function(e,t,o){var r=this,a=this;this.showCheckbox&&t&&(this.tempNode.length>0&&this.tempNode[0].data[this.parentId]!==e[this.parentId]?this.$message("请选择同级部门"):(this.tempNode=[],this.$refs.selectTree.getCheckedNodes().forEach(function(t){e.parentCode===t.parentCode&&r.tempNode.push(r.findNode(t[r.mysortId]))})),this.$nextTick(function(){a.setChecked()}))},findNode:function(e){var t=this,o=[],r=void 0;t.$refs.selectTree.$children.forEach(function(e){o.push(e.node)});return function o(a){for(var s=0;s<a.length;s++)e==a[s].data[t.mysortId]&&(r=a[s]),a[s].childNodes&&o(a[s].childNodes)}(o),r},bubbleSort:function(){for(var e=0;e<this.tempNode.length;e++)for(var t=e+1;t<this.tempNode.length;t++)if(this.tempNode[e].data[this.sortStr]>=this.tempNode[t].data[this.sortStr]){var o=this.tempNode[t];this.tempNode[t]=this.tempNode[e],this.tempNode[e]=o}},moveUp:function(){var e=this.moveData(!0);this.move(e.first,e.second)},moveDown:function(){var e=this.moveData(!1);this.move(e.first,e.second)},moveData:function(e){var t=this;return{first:function(){for(var o=0,r=0,a=0;a<t.tempNode[0].parent.childNodes.length;a++)if(t.tempNode[0].parent.childNodes[a].key==t.tempNode[o].key&&(t.tempNode[0].parent.childNodes.splice(a,1),0==o&&(r=a),a--,++o==t.tempNode.length)){var s;e||(r=a+1),(s=t.tempNode[0].parent.childNodes).splice.apply(s,[r,0].concat(i()(t.tempNode)));break}},second:function(){if(e?t.tempNode[0].parent.childNodes[0].key!==t.tempNode[0].key:t.tempNode[0].parent.childNodes[t.tempNode[0].parent.childNodes.length-1].key!==t.tempNode[t.tempNode.length-1].key){for(var o=0;o<t.tempNode[0].parent.childNodes.length;o++)if(t.tempNode[0].parent.childNodes[o].key==t.tempNode[0].key){var r;t.tempNode[0].parent.childNodes.splice(o,t.tempNode.length),e||(o+=2),(r=t.tempNode[0].parent.childNodes).splice.apply(r,[o-1,0].concat(i()(t.tempNode)));break}}else e?t.$message("已经是第一个"):t.$message("已经是最后一个")}}},move:function(e,t){var o=this;if(o.tempNode.length<=0)return void o.$message("请先选择部门");o.bubbleSort(),o.tempNode[0].parent.childNodes=this.addSortNum(o.tempNode[0].parent.childNodes);var r=0;new a.a(function(e,t){for(var s=0;s<o.tempNode[0].parent.childNodes.length;s++){var i=o.tempNode[0].parent.childNodes[s];if(i.key==o.tempNode[0].key)r=-s;else if(i.key==o.tempNode[o.tempNode.length-1].key){r=s+r;break}}return r>0&&r+1>o.tempNode.length?e():t(),new a.a(function(e,t){e()})}).then(function(){e()},function(){t()}).then(function(){o.reSortNode()}).then(function(){o.isChanged=!0})},reSortNode:function(){var e=this.tempNode[0].parent.childNodes,t=this,o=0,r=0;if(e[0].key===t.tempNode[0].key)o=0<e[1]?0:-e[1].data[t.sortStr];else for(var a=0,s=e.length;a<s;a++)e[a].key===t.tempNode[0].key&&(o=e[a-1].data[t.sortStr]);if(e[e.length-1].key===t.tempNode[t.tempNode.length-1].key)r=e[e.length-2].data[t.sortStr]>=1e4*e.length?e[e.length-2].data[t.sortStr]+1e4:1e4*e.length;else for(var i=e.length-1;i>=0;i--)e[i].key==t.tempNode[t.tempNode.length-1].key&&(r=e[i+1].data[t.sortStr]);var n=Math.floor((r-o)/(t.tempNode.length+1));if(n<10||e[e.length-2].data[t.sortStr]>1e9)for(var l=0,d=e.length;l<d;l++){e[l].data[t.sortStr]=1e4*(l+1);var c=this.initSortKey.indexOf(e[l].data[this.mysortId]);c>-1?this.initSort[c][this.sortStr]=e[l].data[this.sortStr]:(this.initSort.push(e[l].data),this.initSortKey.push(e[l].data[this.mysortId]))}else for(var u=0;u<t.tempNode.length;u++)t.tempNode[u].data[t.sortStr]=o+(u+1)*n;this.dealReSort()},send:function(){var e=this;if(this.tempNode.length<1)return void this.$message("请先选择部门");if(!this.isChanged)return void this.$message("没有改变");var t=[];this.initSort.forEach(function(o,r){t.push({sortCode:e.sortCode,sortId:o[e.mysortId],sortValue:o[e.sortStr]})}),this.isChanged=!1,this.$ajax.put(this.urlLink,t).then(function(t){t.data.success?e.$message.success(t.data.msg):e.$message.error(t.data.msg),e.$emit("sendBack",t.data.success)},function(){e.$message("网络错误,请检查网络")})},checkHeight:function(){var e=document.getElementById("selectTree").parentElement;e.offsetHeight,e.style.paddingTop,e.style.paddingBottom;e.children[0].addEventListener("scroll",function(){console.log(e.children[0].scrollTop)})},dealReSort:function(){var e=this;this.tempNode.forEach(function(t,o){var r=e.initSortKey.indexOf(t.data[e.mysortId]);r>-1?e.initSort[r][e.sortStr]=t.data[e.sortStr]:(e.initSort.push(t.data),e.initSortKey.push(t.data[e.mysortId]))})},addSortNum:function(e){for(var t=e.length,o=0,r=0;r<t;r++)if(null!==e[r][this.sortStr]){o=Math.floor(e[r][this.sortStr]/(r+1)),o=o>10?o:0;break}for(var a=0;a<t;a++)if(null===e[a][this.sortStr])e[a][this.sortStr]=(a+1)*(o||1e4),this.initSort.push(e[a]),this.initSortKey.push(e[a][this.mysortId]);else{if(0!==o)break;e[a][this.sortStr]=1e4*(a+1)}return e}},created:function(){var e=this;this.props.label=this.mysortName,this.defaultExpanded=[],this.data.forEach(function(t,o){e.defaultExpanded.push(t[e.mysortId])})},mounted:function(){var e=this;document.addEventListener("keydown",function(t){t=t||window.event,e.isShift||e.isCtrl||"Control"!=t.key||(e.isCtrl=!0),e.isShift||"Shift"!=t.key||(e.isShift=!0,e.isCtrl=!1)}),document.addEventListener("keyup",function(t){t=t||window.event,"Control"==t.key&&(e.isCtrl=!1),"Shift"==t.key&&(e.isShift=!1,t.ctrlKey&&(e.isCtrl=!0)),e.tempNode.length>=1&&("ArrowUp"==t.key?e.moveUp():"ArrowDown"==t.key&&e.moveDown())}),this.checkHeight()},watch:{clearLis:function(e){e?this.checkHeight():(this.tempNode=[],this.initSort=[],this.initSortKey=[],this.setChecked())},data:function(e){this.localData=e}}}},"djy/":function(e,t,o){var r=o("PUDX");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o("FIqI")("fcb03b24",r,!0,{})},gQYe:function(e,t,o){"use strict";function r(e){o("ptEs")}Object.defineProperty(t,"__esModule",{value:!0});var a=o("AGvZ"),s=o("BZUC"),i=o("J0+h"),n=r,l=i(a.a,s.a,n,null,null);t.default=l.exports},ptEs:function(e,t,o){var r=o("saVm");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o("FIqI")("58f5b9fc",r,!0,{})},pwqh:function(e,t,o){"use strict";var r=(o("yt7g"),o("yt7g"));t.a={props:{value:{type:Object},moduleId:{type:[String,Number]},initCheck:{type:Object},groupList:{type:Array},detailList:{type:Array}},data:function(){return{selectGroup:"",groupCheckList:[],detialCheckList:[],groupDetialCheckList:{}}},watch:{"initCheck.detailCheckedLists":function(e){if(e.length>0){var t={};e.forEach(function(e){t[e.nameCode]||(t[e.nameCode]=[]),t[e.nameCode].push(e.id)}),this.groupDetialCheckList=t,this.selectGroup&&this.groupDetialCheckList[this.selectGroup]&&(this.detialCheckList=o.i(r.l)(this.groupDetialCheckList[this.selectGroup]))}else this.detialCheckList=[],this.groupDetialCheckList={}},"initCheck.groupCheckedLists":function(e){e.length>0?(this.groupCheckList=e.map(function(e){return e.nameCode}),this.selectGroup=this.groupCheckList[0],this.groupDetialCheckList[this.selectGroup]&&(this.detialCheckList=o.i(r.l)(this.groupDetialCheckList[this.selectGroup]))):(this.groupCheckList=[],this.selectGroup="",this.detialCheckList=[])}},methods:{selectGroupHandle:function(e){this.selectGroup=e,this.detialCheckList=o.i(r.l)(this.groupDetialCheckList[this.selectGroup]||[])},unique:function(e,t,o){for(var r={},a={},s=[],i=[],n=0,l=e.length;n<l;n++)r[e[n]]=!0;for(var d=0,c=t.length;d<c;d++)a[t[d]]=!0;for(var u=0,h=e.length;u<h;u++)a[e[u]]||s.push(o(e[u],u,"del"));for(var p=0,f=t.length;p<f;p++)r[t[p]]||i.push(o(t[p],p,"add"));return{del:s,add:i}},changeGroup:function(e){var t=this,o=this.initCheck.groupCheckedLists.map(function(e){return e.nameCode}),r=this.unique(o,e,function(e,o,r){var a={moduleId:t.moduleId,nameCode:e};return"del"===r&&(a.id=t.initCheck.groupCheckedLists[o].id),a});this.value.handleSaveList.handleList=r.add,this.value.handleDeleteList.handleList=r.del,this.$emit("input",this.value)},changeRes:function(e){var t=this;-1===this.groupCheckList.indexOf(this.selectGroup)&&(this.groupCheckList.push(this.selectGroup),this.changeGroup(this.groupCheckList)),this.groupDetialCheckList[this.selectGroup]=e;var o=this.initCheck.detailCheckedLists.map(function(e){return e.nameCode+"_"+e.id}),r=[];for(var a in this.groupDetialCheckList)for(var s=this.groupDetialCheckList[a],i=0,n=s.length;i<n;i++)r.push(a+"_"+s[i]);var l=this.unique(o,r,function(e,o,r){var a=e.split("_"),s={resourceId:a[1],nameCode:a[0],moduleId:t.moduleId};return"del"===r&&(s.id=t.initCheck.detailCheckedLists[o].moduleHandleResourceId),s});this.value.handleSaveList.resourceList=l.add,this.value.handleDeleteList.resourceList=l.del,this.$emit("input",this.value)}}}},saVm:function(e,t,o){t=e.exports=o("acE3")(!0),t.push([e.i,'.module_div_search{display:flex;justify-content:space-between}.module_div_operation{margin-bottom:10px}.module_div_operation i{font-size:12px}.module_div_operation i:first-of-type{font-size:14px}.module-div-sourceDialog{overflow:auto}.module-div-sourceDialog>.el-dialog{width:750px}.module-div-sourceDialog .el-dialog__body{padding:5px 15px 10px}.module-div-addDialog .el-dialog__body{padding-right:50px;max-height:450px}@media screen and (min-height:820px){.module-div-addDialog .el-dialog__body{max-height:none}}.module-div-addDialog .el-cascader,.module-div-addDialog .el-select{width:100%}.module-div-form .el-input{width:100px}.source-table{margin-top:10px}.source-div-addDialog.el-dialog__wrapper{overflow:visible}.source-div-addDialog>.el-dialog{width:500px}.source-div-addDialog>.el-dialog .el-dialog__body{padding-left:45px}.source-div-addDialog .el-form-item__label{min-width:100px}.source-div-addDialog .el-input,.source-div-addDialog .el-input__inner{width:200px}.module-div-sourceDialog .el-transfer-panel:nth-child(3) .transfer-content{display:inline-block;max-width:230px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.module-label-source{position:absolute;top:3px;right:16px;height:14px;width:14px}.module-div-sourceDialog .el-transfer-panel:first-of-type\r\n  .module-label-source{display:none}.transfer-accredited:checked+.el-checkbox__inner:after{transform:rotate(45deg) scaleY(1);border-color:#20a0ff}.transfer-accredited:checked+.el-checkbox__inner{border-color:#20a0ff}.base-treeGrid .disabled{color:#919191}.base-treeGrid .disabled .el-checkbox__inner{border:1px solid #919191}.base-treeGrid .disabled .el-button--info,.base-treeGrid .disabled .el-button--warning{background:#eee;color:#919191;border-color:#919191}.module-source-isNecessary{position:fixed;right:-82px;top:134px;z-index:9999;background:#e4f5ff;color:#333;font-size:12px;padding:5px;border:1px solid #67a7d3}.module-source-isNecessary:after{display:inline-block;cursor:pointer;width:0;height:0;border:6px solid transparent;border-top-width:7px;border-top-color:#67a7d3;border-bottom-width:0;content:"";position:absolute;left:10px;top:24px}.module-source-isNecessary strong{cursor:pointer;color:#007acf}.el-transfer-panel__empty[style*="display: none;"]~.module-source-isNecessary{display:none}.el-transfer-panel__body .el-transfer-panel__empty:first-of-type[style*="display: none;"]\r\n  + .el-transfer-panel__empty[style*="display: none;"]\r\n  + .module-source-isNecessary{display:block}',"",{version:3,sources:["C:/vscode/ysems_webapp/src/views/platform/basic/module.vue"],names:[],mappings:"AACA,mBACE,aAAc,AACd,6BAA+B,CAChC,AACD,sBACE,kBAAoB,CACrB,AACD,wBACE,cAAgB,CACjB,AACD,sCACE,cAAgB,CACjB,AACD,yBACE,aAAe,CAChB,AACD,oCACE,WAAa,CACd,AACD,0CACE,qBAAuB,CACxB,AACD,uCACE,mBAAoB,AACpB,gBAAkB,CACnB,AACD,qCACA,uCACI,eAAiB,CACpB,CACA,AACD,oEAEE,UAAY,CACb,AACD,2BACE,WAAa,CACd,AAGD,cACE,eAAiB,CAClB,AACD,yCACE,gBAAkB,CACnB,AACD,iCACE,WAAa,CACd,AACD,kDACE,iBAAmB,CACpB,AACD,2CACE,eAAiB,CAClB,AACD,uEAEE,WAAa,CACd,AACD,2EACE,qBAAsB,AACtB,gBAAiB,AACjB,gBAAiB,AACjB,uBAAwB,AACxB,kBAAoB,CACrB,AACD,qBACE,kBAAmB,AACnB,QAAS,AACT,WAAY,AACZ,YAAa,AACb,UAAY,CACb,AACD;uBAGE,YAAc,CACf,AAKD,uDACE,kCAAmC,AACnC,oBAAsB,CACvB,AACD,iDACE,oBAAsB,CACvB,AAGD,yBACE,aAAe,CAChB,AACD,6CACE,wBAA0B,CAC3B,AACD,uFAEE,gBAAiB,AACjB,cAAe,AACf,oBAAsB,CACvB,AAGD,2BACE,eAAgB,AAChB,YAAa,AACb,UAAW,AACX,aAAc,AACd,mBAAoB,AACpB,WAAY,AACZ,eAAgB,AAChB,YAAa,AACb,wBAA0B,CAC3B,AACD,iCACE,qBAAsB,AACtB,eAAgB,AAChB,QAAS,AACT,SAAU,AACV,6BAA8B,AAC9B,qBAAsB,AACtB,yBAA0B,AAC1B,sBAAyB,AACzB,WAAY,AACZ,kBAAmB,AACnB,UAAW,AACX,QAAU,CACX,AACD,kCACE,eAAgB,AAChB,aAAe,CAChB,AACD,8EAEE,YAAc,CACf,AACD;;+BAIE,aAAe,CAChB",file:"module.vue",sourcesContent:['\n.module_div_search {\r\n  display: flex;\r\n  justify-content: space-between;\n}\n.module_div_operation {\r\n  margin-bottom: 10px;\n}\n.module_div_operation i {\r\n  font-size: 12px;\n}\n.module_div_operation i:first-of-type {\r\n  font-size: 14px;\n}\n.module-div-sourceDialog {\r\n  overflow: auto;\n}\n.module-div-sourceDialog > .el-dialog {\r\n  width: 750px;\n}\n.module-div-sourceDialog .el-dialog__body {\r\n  padding: 5px 15px 10px;\n}\n.module-div-addDialog .el-dialog__body {\r\n  padding-right: 50px;\r\n  max-height: 450px;\n}\n@media screen and (min-height: 820px) {\n.module-div-addDialog .el-dialog__body {\r\n    max-height: none;\n}\n}\n.module-div-addDialog .el-cascader,\r\n.module-div-addDialog .el-select {\r\n  width: 100%;\n}\n.module-div-form .el-input {\r\n  width: 100px;\n}\r\n\r\n/*资源*/\n.source-table {\r\n  margin-top: 10px;\n}\n.source-div-addDialog.el-dialog__wrapper {\r\n  overflow: visible;\n}\n.source-div-addDialog > .el-dialog {\r\n  width: 500px;\n}\n.source-div-addDialog > .el-dialog .el-dialog__body {\r\n  padding-left: 45px;\n}\n.source-div-addDialog .el-form-item__label {\r\n  min-width: 100px;\n}\n.source-div-addDialog .el-input__inner,\r\n.source-div-addDialog .el-input {\r\n  width: 200px;\n}\n.module-div-sourceDialog .el-transfer-panel:nth-child(3) .transfer-content {\r\n  display: inline-block;\r\n  max-width: 230px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\n}\n.module-label-source {\r\n  position: absolute;\r\n  top: 3px;\r\n  right: 16px;\r\n  height: 14px;\r\n  width: 14px;\n}\n.module-div-sourceDialog\r\n  .el-transfer-panel:nth-of-type(1)\r\n  .module-label-source {\r\n  display: none;\n}\r\n\r\n/*.module-div-sourceDialog .el-transfer-panel:nth-child(3) {*/\r\n/*width: 450px;*/\r\n/*}*/\n.transfer-accredited:checked + .el-checkbox__inner::after {\r\n  transform: rotate(45deg) scaleY(1);\r\n  border-color: #20a0ff;\n}\n.transfer-accredited:checked + .el-checkbox__inner {\r\n  border-color: #20a0ff;\n}\r\n\r\n/*被禁用后的样式*/\n.base-treeGrid .disabled {\r\n  color: #919191;\n}\n.base-treeGrid .disabled .el-checkbox__inner {\r\n  border: 1px solid #919191;\n}\n.base-treeGrid .disabled .el-button--warning,\r\n.base-treeGrid .disabled .el-button--info {\r\n  background: #eee;\r\n  color: #919191;\r\n  border-color: #919191;\n}\r\n\r\n/*是否必须资源*/\n.module-source-isNecessary {\r\n  position: fixed;\r\n  right: -82px;\r\n  top: 134px;\r\n  z-index: 9999;\r\n  background: #e4f5ff;\r\n  color: #333;\r\n  font-size: 12px;\r\n  padding: 5px;\r\n  border: 1px solid #67a7d3;\n}\n.module-source-isNecessary::after {\r\n  display: inline-block;\r\n  cursor: pointer;\r\n  width: 0;\r\n  height: 0;\r\n  border: 6px solid transparent;\r\n  border-top-width: 7px;\r\n  border-top-color: #67a7d3;\r\n  border-bottom-width: 0px;\r\n  content: "";\r\n  position: absolute;\r\n  left: 10px;\r\n  top: 24px;\n}\n.module-source-isNecessary strong {\r\n  cursor: pointer;\r\n  color: #007acf;\n}\n.el-transfer-panel__empty[style*="display: none;"]\r\n  ~ .module-source-isNecessary {\r\n  display: none;\n}\n.el-transfer-panel__body\r\n  .el-transfer-panel__empty:nth-of-type(1)[style*="display: none;"]\r\n  + .el-transfer-panel__empty[style*="display: none;"]\r\n  + .module-source-isNecessary {\r\n  display: block;\n}\r\n'],sourceRoot:""}])},x8pc:function(e,t,o){"use strict";function r(e){o("djy/")}var a=o("pwqh"),s=o("zCe2"),i=o("J0+h"),n=r,l=i(a.a,s.a,n,"data-v-32973260",null);t.a=l.exports},zCe2:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"wrap"},[o("div",{staticClass:"left"},[o("p",[e._v("功能")]),e._v(" "),o("el-checkbox-group",{on:{change:e.changeGroup},model:{value:e.groupCheckList,callback:function(t){e.groupCheckList=t},expression:"groupCheckList"}},[o("ul",e._l(e.groupList,function(t){return o("li",{key:t.nameCode,class:{groupActive:e.selectGroup===t.nameCode}},[o("el-checkbox",{staticClass:"input_no_text",attrs:{label:t.nameCode}}),e._v(" "),o("el-button",{attrs:{type:"text"},on:{click:function(o){e.selectGroupHandle(t.nameCode)}}},[e._v(e._s(t.name))])],1)}))])],1),e._v(" "),o("div",{staticClass:"right"},[o("p",[e._v("资源")]),e._v(" "),e.detailList.length>0?o("el-checkbox-group",{on:{change:e.changeRes},model:{value:e.detialCheckList,callback:function(t){e.detialCheckList=t},expression:"detialCheckList"}},[o("ul",e._l(e.detailList,function(t){return o("li",{key:t.name_code},[o("el-checkbox",{staticClass:"input_no_text",attrs:{label:t.id}}),e._v(" "),o("el-button",{attrs:{type:"text"}},[e._v(e._s(t.name))])],1)}))]):o("p",[e._v("请添加资源")])],1)]),e._v(" "),o("small",[e._v("*取消左侧功能将会导致资源被删除。")])])},a=[],s={render:r,staticRenderFns:a};t.a=s}});
//# sourceMappingURL=6.58743c42ef54c7f22144.js.map