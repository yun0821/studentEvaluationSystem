{"version":3,"sources":["webpack:///static/js/34.3aa689d87646aefbf75a.js","webpack:///./src/views/platform/efficiencyAnalysis/efficiencyMapAnalysis.vue","webpack:///./src/views/platform/efficiencyAnalysis/efficiencyMapAnalysis.vue?6dfd","webpack:///src/views/platform/efficiencyAnalysis/efficiencyMapAnalysis.vue","webpack:///./src/svg/test.svg"],"names":["webpackJsonp","CjTy","module","__webpack_exports__","__webpack_require__","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_script_index_0_efficiencyMapAnalysis_vue__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_0_4_vue_loader_lib_template_compiler_index_id_data_v_19da416f_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_template_index_0_efficiencyMapAnalysis_vue__","normalizeComponent","Component","Lct1","render","_vm","this","_h","$createElement","_c","_self","_v","attrs","time-type","dateType","show-time","on","update:timeType","$event","change","changeTime","model","callback","$$v","selectTime","expression","maxNum","option-lists","energySubitemList","label","value-key","loadEnergyData","rdsEnergySubitem","_s","unit","id","data","svg","type","staticRenderFns","esExports","R1Mo","__WEBPACK_IMPORTED_MODULE_0__util_util_js__","name","orgIds","energyData","methods","inintData","t1","Date","$moment","i","loadData","_this","$ajax","all","getEnergySubitemList","getOrgTreeData","then","res","status","records","getOrgID","length","substring","$nextTick","url","method","params","title","children","getElementFormSvg","object","document","getElementById","svgDoc","contentDocument","e","getSvgElement","console","log","_this2","me","startTime","endTime","times","timeArr","split","energyIds","targetCycle","targetTypes","$store","state","targetConstant","targetType","energyConsum","contentTypes","targetContentType","energy","contentIds","objTypes","objTypeValues","isQueryAll","isOrgId","isContentType","isObjType","targetUnit","c","organizationId","textContent","dataValue","toFixed","_svgDoc","orgArr","_i","$message","warning","date","mounted","_this3","onload","Wsna","exports","p"],"mappings":"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","file":"static/js/34.3aa689d87646aefbf75a.js","sourcesContent":["webpackJsonp([34],{\n\n/***/ \"CjTy\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_script_index_0_efficiencyMapAnalysis_vue__ = __webpack_require__(\"R1Mo\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_0_4_vue_loader_lib_template_compiler_index_id_data_v_19da416f_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_template_index_0_efficiencyMapAnalysis_vue__ = __webpack_require__(\"Lct1\");\nvar normalizeComponent = __webpack_require__(\"J0+h\")\n/* script */\n\n/* template */\n\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_script_index_0_efficiencyMapAnalysis_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_0_4_vue_loader_lib_template_compiler_index_id_data_v_19da416f_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_node_modules_vue_loader_13_0_4_vue_loader_lib_selector_type_template_index_0_efficiencyMapAnalysis_vue__[\"a\" /* default */],\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ }),\n\n/***/ \"Lct1\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_vm._v(\"\\n  时间：\\n  \"), _c('da-time-select', {\n    attrs: {\n      \"time-type\": _vm.dateType,\n      \"show-time\": [3, 5, 8]\n    },\n    on: {\n      \"update:timeType\": function($event) {\n        _vm.dateType = $event\n      },\n      \"change\": _vm.changeTime\n    },\n    model: {\n      value: (_vm.selectTime),\n      callback: function($$v) {\n        _vm.selectTime = $$v\n      },\n      expression: \"selectTime\"\n    }\n  }), _vm._v(\"\\n  能源：\\n  \"), _c('da-radio-select', {\n    attrs: {\n      \"maxNum\": 5,\n      \"option-lists\": _vm.energySubitemList,\n      \"label\": \"name\",\n      \"value-key\": \"id\"\n    },\n    on: {\n      \"change\": _vm.loadEnergyData\n    },\n    model: {\n      value: (_vm.rdsEnergySubitem),\n      callback: function($$v) {\n        _vm.rdsEnergySubitem = $$v\n      },\n      expression: \"rdsEnergySubitem\"\n    }\n  }), _vm._v(\"\\n  单位：\" + _vm._s(_vm.unit) + \"\\n  \"), _c('div'), _vm._v(\" \"), _c('object', {\n    attrs: {\n      \"id\": \"svgId\",\n      \"data\": _vm.svg,\n      \"type\": \"image/svg+xml\"\n    }\n  })], 1)\n}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n\n/***/ \"R1Mo\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__util_util_js__ = __webpack_require__(\"yt7g\");\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  name: \"efficiencyMapAnalysis\",\n  data: function data() {\n    return {\n      svg: __webpack_require__(\"Wsna\"),\n      rdsEnergySubitem: \"35\", //选择的能源\n      energySubitemList: [], // 能源种类列表\n      selectTime: \"\", //所选择的日期\n      dateType: 5, //日期类型\n      orgIds: \"\", //组织机构ID\n      energyData: [], //能耗数据\n      unit: \"\" //能源单位\n    };\n  },\n\n  methods: {\n    //初始化数据\n    inintData: function inintData() {\n      this.dateType = 5; //日期类型默认为日\n      var t1 = new Date();\n      t1 = this.$moment(t1, \"YYYY-MM\");\n      this.selectTime = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__util_util_js__[\"g\" /* calcTime */])(t1, -1, 5, \"YYYY-MM\"); //设置为上个月\n    },\n\n\n    //加载数据\n    loadData: function loadData() {\n      var _this = this;\n\n      this.$ajax.all([this.getEnergySubitemList(), this.getOrgTreeData()]).then(function (res) {\n        if (res[0].data.status) {\n          _this.energySubitemList = res[0].data.records;\n          _this.rdsEnergySubitem = 35; //me.energySubitemList[0].id; //默认是电\n        }\n\n        if (res[1].data.status) {\n          _this.getOrgID(res[1].data.records);\n        }\n\n        if (_this.orgIds.length > 0) {\n          _this.orgIds = _this.orgIds.substring(0, _this.orgIds.length - 1);\n        }\n        _this.$nextTick(function () {\n          _this.loadEnergyData();\n        });\n      });\n    },\n\n    //加载组织架构树数据\n    getOrgTreeData: function getOrgTreeData() {\n      var me = this;\n      return me.$ajax({\n        url: \"rest/analysisData/departTree\",\n        method: \"get\",\n        params: { title: \"组织架构数据\" }\n      });\n    },\n\n    //查询能源种类\n    getEnergySubitemList: function getEnergySubitemList() {\n      var me = this;\n      return me.$ajax({\n        url: \"rest/analysisData/energy\",\n        method: \"get\",\n        params: { title: \"能源种类\" }\n      });\n    },\n\n    //递归循环遍历获取用能对象ID\n    getOrgID: function getOrgID(records) {\n      for (var i = 0; i < records.length; i++) {\n        this.orgIds += records[i].id + \",\";\n        if (records[i].children != null && records[i].children.length > 0) {\n          this.getOrgID(records[i].children);\n        }\n      }\n    },\n\n    // 根据id获取svg内的对象，并可调用dom元素操作；传入callback可对修改内部函数\n    getElementFormSvg: function getElementFormSvg(id) {\n      var object = document.getElementById(id);\n      var svgDoc = null;\n      try {\n        svgDoc = object.contentDocument;\n      } catch (e) {\n        try {\n          svgDoc = object.getSvgElement();\n        } catch (e) {\n          console.log(\"svg in object not support in your environment.\");\n        }\n      }\n      return svgDoc;\n    },\n\n    //加载能耗数据\n    loadEnergyData: function loadEnergyData() {\n      var _this2 = this;\n\n      var me = this;\n      var startTime = \"\";\n      var endTime = \"\";\n      var times = [];\n      me.unit = \"\";\n      if (me.dateType == 3) {\n        startTime = this.selectTime;\n        endTime = me.$moment(startTime + \" 23:59:59\", \"YYYY-MM-DD HH:mm:ss\");\n      } else if (me.dateType == 5) {\n        times = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__util_util_js__[\"f\" /* cycleTime */])(this.selectTime, 5);\n        startTime = times[0];\n        endTime = times[1];\n      } else if (me.dateType == 8) {\n        startTime = this.selectTime + \"-01-01\";\n        var timeArr = this.selectTime.split(\"-\");\n        endTime = timeArr[0] + \"-12-31\";\n      }\n\n      var energyIds = me.rdsEnergySubitem;\n      me.$ajax({\n        url: \"rest/analysisData/targetData\",\n        method: \"get\",\n        params: {\n          title: \"能耗数据\",\n          orgIds: \"\", //组织架构ID\n          targetCycle: me.dateType, //指标周期\n          targetTypes: me.$store.state.targetConstant.targetType.energyConsum, //指标类型\n          contentTypes: me.$store.state.targetConstant.targetContentType.energy, //统计内容类型\n          contentIds: energyIds, //统计内容ID，此处为能源ID\n          objTypes: \"\", //指标关联对象类型\n          objTypeValues: \"\", //指标关联对象类型对应的值\n          isQueryAll: false, // Boolean,是否所有指标数据\n          startTime: startTime, //开始时间\n          endTime: endTime, //结束时间\n          isOrgId: true, // Boolean,是否返回部门ID\n          isContentType: false, // Boolean,是否返回指标统计内容类型ID\n          isObjType: \"\" // String,是否返回指标关联对象,1为班组，2为设备，3为产品\n        }\n      }).then(function (res) {\n        // if (res.data.status) {\n        me.energyData = res.data.records;\n        if (me.energyData != null && me.energyData.length > 0) {\n          var svgDoc = _this2.getElementFormSvg(\"svgId\");\n          //循环遍历查找对象并赋值\n          for (var i = 0; i < me.energyData.length; i++) {\n            _this2.unit = me.energyData[i].targetUnit;\n            var c = svgDoc.getElementById(\"OBID_\" + me.energyData[i].organizationId);\n            // console.log(c);\n            if (c != null) {\n              c.textContent = me.energyData[i].dataValue.toFixed(2);\n              //c.setAttribute('fill','red');\n            }\n          }\n        } else {\n          //若无数据，则清空数据\n          var _svgDoc = _this2.getElementFormSvg(\"svgId\");\n          var orgArr = _this2.orgIds.split(\",\");\n          for (var _i = 0; _i < orgArr.length; _i++) {\n            var _c = _svgDoc.getElementById(\"OBID_\" + orgArr[_i]);\n\n            if (_c != null) {\n              _c.textContent = \"\";\n            }\n          }\n          _this2.$message.warning(\"没有查询到数据！\");\n        }\n        // }\n      });\n    },\n\n    //日期更改时的触发事件\n    changeTime: function changeTime(date, type) {\n      if (date) {\n        this.dateType = type;\n        this.selectTime = date;\n\n        this.loadEnergyData();\n      }\n    }\n  },\n  mounted: function mounted() {\n    var _this3 = this;\n\n    this.inintData();\n\n    var object = document.getElementById(\"svgId\");\n    object.onload = function () {\n      _this3.loadData();\n    };\n  }\n});\n\n/***/ }),\n\n/***/ \"Wsna\":\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/img/test.ccc6a25.svg\";\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/34.3aa689d87646aefbf75a.js","var normalizeComponent = require(\"!../../../../node_modules/_vue-loader@13.0.4@vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/_vue-loader@13.0.4@vue-loader/lib/selector?type=script&index=0!./efficiencyMapAnalysis.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/_vue-loader@13.0.4@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-19da416f\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"}}!../../../../node_modules/_vue-loader@13.0.4@vue-loader/lib/selector?type=template&index=0!./efficiencyMapAnalysis.vue\"\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/platform/efficiencyAnalysis/efficiencyMapAnalysis.vue\n// module id = CjTy\n// module chunks = 34","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_vm._v(\"\\n  时间：\\n  \"), _c('da-time-select', {\n    attrs: {\n      \"time-type\": _vm.dateType,\n      \"show-time\": [3, 5, 8]\n    },\n    on: {\n      \"update:timeType\": function($event) {\n        _vm.dateType = $event\n      },\n      \"change\": _vm.changeTime\n    },\n    model: {\n      value: (_vm.selectTime),\n      callback: function($$v) {\n        _vm.selectTime = $$v\n      },\n      expression: \"selectTime\"\n    }\n  }), _vm._v(\"\\n  能源：\\n  \"), _c('da-radio-select', {\n    attrs: {\n      \"maxNum\": 5,\n      \"option-lists\": _vm.energySubitemList,\n      \"label\": \"name\",\n      \"value-key\": \"id\"\n    },\n    on: {\n      \"change\": _vm.loadEnergyData\n    },\n    model: {\n      value: (_vm.rdsEnergySubitem),\n      callback: function($$v) {\n        _vm.rdsEnergySubitem = $$v\n      },\n      expression: \"rdsEnergySubitem\"\n    }\n  }), _vm._v(\"\\n  单位：\" + _vm._s(_vm.unit) + \"\\n  \"), _c('div'), _vm._v(\" \"), _c('object', {\n    attrs: {\n      \"id\": \"svgId\",\n      \"data\": _vm.svg,\n      \"type\": \"image/svg+xml\"\n    }\n  })], 1)\n}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_vue-loader@13.0.4@vue-loader/lib/template-compiler?{\"id\":\"data-v-19da416f\",\"hasScoped\":false,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"}}!./~/_vue-loader@13.0.4@vue-loader/lib/selector.js?type=template&index=0!./src/views/platform/efficiencyAnalysis/efficiencyMapAnalysis.vue\n// module id = Lct1\n// module chunks = 34","<template>\r\n  <div>\r\n    时间：\r\n    <da-time-select v-model=\"selectTime\" :time-type.sync=\"dateType\" :show-time=\"[3,5,8]\" @change=\"changeTime\"></da-time-select>\r\n    能源：\r\n    <da-radio-select v-model=\"rdsEnergySubitem\" :maxNum=\"5\" :option-lists=\"energySubitemList\" @change=\"loadEnergyData\" label=\"name\" value-key=\"id\"></da-radio-select>\r\n    单位：{{unit}}\r\n    <div>\r\n    </div>\r\n    <object id=\"svgId\" :data=\"svg\" type=\"image/svg+xml\"></object>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { calcTime, cycleTime } from \"@/util/util.js\";\r\nexport default {\r\n  name: \"efficiencyMapAnalysis\",\r\n  data() {\r\n    return {\r\n      svg: require(\"../../../svg/test.svg\"),\r\n      rdsEnergySubitem: \"35\", //选择的能源\r\n      energySubitemList: [], // 能源种类列表\r\n      selectTime: \"\", //所选择的日期\r\n      dateType: 5, //日期类型\r\n      orgIds: \"\", //组织机构ID\r\n      energyData: [], //能耗数据\r\n      unit: \"\" //能源单位\r\n    };\r\n  },\r\n  methods: {\r\n    //初始化数据\r\n    inintData() {\r\n      this.dateType = 5; //日期类型默认为日\r\n      let t1 = new Date();\r\n      t1 = this.$moment(t1, \"YYYY-MM\");\r\n      this.selectTime = calcTime(t1, -1, 5, \"YYYY-MM\"); //设置为上个月\r\n    },\r\n\r\n    //加载数据\r\n    loadData() {\r\n      this.$ajax\r\n        .all([this.getEnergySubitemList(), this.getOrgTreeData()])\r\n        .then(res => {\r\n          if (res[0].data.status) {\r\n            this.energySubitemList = res[0].data.records;\r\n            this.rdsEnergySubitem = 35; //me.energySubitemList[0].id; //默认是电\r\n          }\r\n\r\n          if (res[1].data.status) {\r\n            this.getOrgID(res[1].data.records);\r\n          }\r\n\r\n          if (this.orgIds.length > 0) {\r\n            this.orgIds = this.orgIds.substring(0, this.orgIds.length - 1);\r\n          }\r\n          this.$nextTick(() => {\r\n            this.loadEnergyData();\r\n          });\r\n        });\r\n    },\r\n    //加载组织架构树数据\r\n    getOrgTreeData() {\r\n      let me = this;\r\n      return me.$ajax({\r\n        url: \"rest/analysisData/departTree\",\r\n        method: \"get\",\r\n        params: { title: \"组织架构数据\" }\r\n      });\r\n    },\r\n    //查询能源种类\r\n    getEnergySubitemList() {\r\n      let me = this;\r\n      return me.$ajax({\r\n        url: \"rest/analysisData/energy\",\r\n        method: \"get\",\r\n        params: { title: \"能源种类\" }\r\n      });\r\n    },\r\n    //递归循环遍历获取用能对象ID\r\n    getOrgID(records) {\r\n      for (let i = 0; i < records.length; i++) {\r\n        this.orgIds += records[i].id + \",\";\r\n        if (records[i].children != null && records[i].children.length > 0) {\r\n          this.getOrgID(records[i].children);\r\n        }\r\n      }\r\n    },\r\n    // 根据id获取svg内的对象，并可调用dom元素操作；传入callback可对修改内部函数\r\n    getElementFormSvg(id) {\r\n      var object = document.getElementById(id);\r\n      var svgDoc = null;\r\n      try {\r\n        svgDoc = object.contentDocument;\r\n      } catch (e) {\r\n        try {\r\n          svgDoc = object.getSvgElement();\r\n        } catch (e) {\r\n          console.log(\"svg in object not support in your environment.\");\r\n        }\r\n      }\r\n      return svgDoc;\r\n    },\r\n    //加载能耗数据\r\n    loadEnergyData() {\r\n      let me = this;\r\n      let startTime = \"\";\r\n      let endTime = \"\";\r\n      let times = [];\r\n      me.unit = \"\";\r\n      if (me.dateType == 3) {\r\n        startTime = this.selectTime;\r\n        endTime = me.$moment(startTime + \" 23:59:59\", \"YYYY-MM-DD HH:mm:ss\");\r\n      } else if (me.dateType == 5) {\r\n        times = cycleTime(this.selectTime, 5);\r\n        startTime = times[0];\r\n        endTime = times[1];\r\n      } else if (me.dateType == 8) {\r\n        startTime = this.selectTime + \"-01-01\";\r\n        let timeArr = this.selectTime.split(\"-\");\r\n        endTime = timeArr[0] + \"-12-31\";\r\n      }\r\n\r\n      let energyIds = me.rdsEnergySubitem;\r\n      me\r\n        .$ajax({\r\n          url: \"rest/analysisData/targetData\",\r\n          method: \"get\",\r\n          params: {\r\n            title: \"能耗数据\",\r\n            orgIds: \"\", //组织架构ID\r\n            targetCycle: me.dateType, //指标周期\r\n            targetTypes: me.$store.state.targetConstant.targetType.energyConsum, //指标类型\r\n            contentTypes:\r\n              me.$store.state.targetConstant.targetContentType.energy, //统计内容类型\r\n            contentIds: energyIds, //统计内容ID，此处为能源ID\r\n            objTypes: \"\", //指标关联对象类型\r\n            objTypeValues: \"\", //指标关联对象类型对应的值\r\n            isQueryAll: false, // Boolean,是否所有指标数据\r\n            startTime: startTime, //开始时间\r\n            endTime: endTime, //结束时间\r\n            isOrgId: true, // Boolean,是否返回部门ID\r\n            isContentType: false, // Boolean,是否返回指标统计内容类型ID\r\n            isObjType: \"\" // String,是否返回指标关联对象,1为班组，2为设备，3为产品\r\n          }\r\n        })\r\n        .then(res => {\r\n          // if (res.data.status) {\r\n          me.energyData = res.data.records;\r\n          if (me.energyData != null && me.energyData.length > 0) {\r\n            let svgDoc = this.getElementFormSvg(\"svgId\");\r\n            //循环遍历查找对象并赋值\r\n            for (let i = 0; i < me.energyData.length; i++) {\r\n              this.unit = me.energyData[i].targetUnit;\r\n              let c = svgDoc.getElementById(\r\n                \"OBID_\" + me.energyData[i].organizationId\r\n              );\r\n              // console.log(c);\r\n              if (c != null) {\r\n                c.textContent = me.energyData[i].dataValue.toFixed(2);\r\n                //c.setAttribute('fill','red');\r\n              }\r\n            }\r\n          } else {\r\n            //若无数据，则清空数据\r\n            let svgDoc = this.getElementFormSvg(\"svgId\");\r\n            let orgArr = this.orgIds.split(\",\");\r\n            for (let i = 0; i < orgArr.length; i++) {\r\n              let c = svgDoc.getElementById(\"OBID_\" + orgArr[i]);\r\n\r\n              if (c != null) {\r\n                c.textContent = \"\";\r\n              }\r\n            }\r\n            this.$message.warning(\"没有查询到数据！\");\r\n          }\r\n          // }\r\n        });\r\n    },\r\n    //日期更改时的触发事件\r\n    changeTime(date, type) {\r\n      if (date) {\r\n        this.dateType = type;\r\n        this.selectTime = date;\r\n\r\n        this.loadEnergyData();\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.inintData();\r\n\r\n    var object = document.getElementById(\"svgId\");\r\n    object.onload = () => {\r\n      this.loadData();\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/platform/efficiencyAnalysis/efficiencyMapAnalysis.vue?d0aebb9c","module.exports = __webpack_public_path__ + \"static/img/test.ccc6a25.svg\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/svg/test.svg\n// module id = Wsna\n// module chunks = 34"],"sourceRoot":""}